'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var ri=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",ri,void 0);var si=function(a){return"urn:x-cast:com.google.cast."+a},ti=si("tp.connection"),ui=si("receiver"),vi=si("media"),wi=si("webrtc"),xi=Xb({Zaa:ti,$aa:si("tp.heartbeat"),saa:ui,rL:vi,w$:si("media.universalRemote.optIn"),rba:wi});var yi={q$:0,h$:1},zi={mba:0,NL:1,taa:2},Ai={DIAL:0,u$:1,v$:2,l9:3},Bi={Q$:0,TIMEOUT:1,t9:2},Ci={lz:0,D8:1,d9:2,G9:3,X8:4,C$:5},Di=function(a){kh("MediaRouter.Cast.Session.Ended",a,zi)},Ei=function(a){kh("MediaRouter.Cast.Discovery.Type",a,Ai)},Fi=function(a){kh("MediaRouter.Cast.Session.Fail",a,Bi)};var Gi=function(a){return"available"==a||"available_rescan"==a};var Hi=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};var Ii=function(a,b){this.cc=this.Qe=this.Qf=this.jb=this.la=null;this.ld=new Hi(Rf.O().wp(b),a);this.Ee={};this.uo={};this.Xk=this.Dv=!1};d=Ii.prototype;d.$f=function(){return this.ld};d.Tl=function(){return this.ld.friendlyName};d.q4=function(a){this.cc=a;return this};d.getId=function(){return this.ld.id};d.Dr=function(a){this.ld.id=a;return this};d.Fr=function(a){this.Dv=a;return this};d.qJ=function(a){this.Xk=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.ld.friendlyName!=a.ld.friendlyName&&(this.ld.friendlyName=a.ld.friendlyName,b=!0);this.Qf!=a.Qf&&(this.Qf=a.Qf,b=!0);this.Qe!=a.Qe&&(this.Qe=a.Qe,b=!0);this.la!=a.la&&(this.la=a.la,b=!0);this.jb!=a.jb&&(this.jb=a.jb,b=!0);return b};d.W3=function(a){this.la=a;return this};d.tb=function(){return this.jb};d.Nk=function(a){this.jb=a;return this};d.u3=function(a){this.Qf=a;return this};d.t3=function(a){this.Qe=a;return this};
d.Id=function(a){return this.Ee[a]||"unknown"};d.EQ=function(a){return this.uo[a]||null};d.yn=function(a,b){this.Ee[a]=b;this.uo[a]=t();return this};d.WJ=function(){return"name = "+this.ld.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", apps = "+JSON.stringify(this.Ee)};var Ji=function(a){var b=new Ii(a.ld.friendlyName,"");b.ld.id=a.ld.id;b.la=a.la;b.jb=a.jb;b.Qf=a.Qf;b.Qe=a.Qe;b.cc=a.cc;b.Ee=a.Ee;b.uo=a.uo;b.Dv=a.Dv;b.Xk=a.Xk;return b};var Li=function(a,b,c,e,f,g){this.Wd=new Hi(Ki(a),b,this.AD(e));this.cc=c||null;this.Zc=e||null;this.la=f||null;this.jb=g||null;this.Ee={};this.Gl=!1},Ki=function(a){return Rf.O().wp(a)},Mi=function(a){if(!a.cc)return null;var b=a.cc;if(!a.la)return null;var c=a.la,e=a.$f().id,f;f=a.$f().friendlyName;f=-1!=f.indexOf("&")?"document"in h?Za(f):$a(f):f;b=new Li(e,f,b,void 0,c,Rf.O().rl||8009);b.Wd.id=a.$f().id;b.yI(!0);return b};d=Li.prototype;
d.update=function(a,b,c,e){var f=!1;this.Wd.friendlyName!=a&&(this.Wd.friendlyName=a,f=!0);this.la!=b&&(this.la=b,f=!0);this.jb!=c&&(this.jb=c,f=!0);this.Zc!=e&&(this.Zc=e,f=!0);return f};d.$f=function(){return this.Wd};d.Tl=function(){return this.Wd.friendlyName};d.AD=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.Z2=function(a){this.Zc=a;this.Wd.iconType=this.AD(this.Zc)};d.getId=function(){return this.Wd.id};d.tb=function(){return this.jb};
d.Id=function(a){return this.Ee[a]||"unknown"};d.yn=function(a,b){this.Ee[a]=b};d.WJ=function(){return"name = "+this.Wd.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", capabilities = "+this.Zc+", apps = "+JSON.stringify(this.Ee)};d.yI=function(a){this.Gl=a};var Ni=function(a,b){this.ve=b;this.lA=a;this.lA.W=this.W.bind(this);this.gh=r(this.hH,this);this.Fc=new A;this.Sk=new A;this.hf=new A;this.kw=null;this.tm=this.og="";this.gj=null;this.iE=this.mm=!1};Ni.prototype.a=C("mr.cast.SinkDiscoveryService");var Oi={serviceType:"_googlecast._tcp.local"};d=Ni.prototype;d.init=function(){qf(this);this.mm&&(this.eF(),this.XB())};d.eF=function(){F(this.a,"Start listening to network changes");chrome.networkingPrivate.onNetworksChanged.addListener(this.XB.bind(this))};
d.start=function(){var a=t();if(chrome.mdns.onServiceList.hasListener(this.gh)){if(6E4>a-this.kw)return;F(this.a,"Forcing mdns discovery");this.kw=a;chrome.mdns.forceDiscovery(ya);chrome.mdns.onServiceList.removeListener(this.gh)}F(this.a,"Adding mdns listener");this.kw=a;chrome.mdns.onServiceList.addListener(this.gh,Oi)};d.stop=function(){F(this.a,"Removing mdns listener");chrome.mdns.onServiceList.removeListener(this.gh)};
d.QO=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return E(this.a,"Missing ID"),null;var e=Ki(c),f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return E(this.a,"Missing or invalid port"),null;if(this.hf.Oa(e)){var g=this.hf.get(e);if(g.la==a.ipAddress&&g.tb()==f)return E(this.a,"Sink has pending connection "+
e),null;E(this.a,"Pending sink changed ip "+e);this.hf.remove(e)}g=b.fn;if(!g||!a.ipAddress)return E(this.a,"Missing friendly name or IP address"),null;var k=Number(b.ca),k=isNaN(k)?0:k;if(e=this.Fc.get(e))return e.update(g,a.ipAddress,f,k)&&(e.yI(!1),this.ve.Qc(e)),null;e=b.md;return e?new Li(c,g,e,k,a.ipAddress,f):(E(this.a,"Missing model name"),null)};d.refresh=function(){G(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(ya)};
d.hH=function(a){F(this.a,"Registering "+a.length+" devices");this.RO(a).forEach(this.MX,this)};d.qA=function(a,b){this.hf.Oa(a.getId())||(this.hf.set(a.getId(),a),this.sl(a).then(function(c){c?(c=this.Fc.get(a.getId()),b&&(c?c.Gl&&Ei(3):Ei(1)),this.mo(a)):F(this.a,"Inaccessible sink: "+a.getId())},null,this).Ab(function(){this.hf.remove(a.getId());0==this.hf.N()&&this.er()},this))};d.MX=function(a){this.qA(a,!0)};d.RO=function(a){var b=[];a.forEach(function(a){(a=this.QO(a))&&b.push(a)},this);return b};
d.mo=function(a){F(this.a,"Adding sink "+a.getId());var b=this.Fc.get(a.getId()),c=null,e=a.la,f=a.tb();null!=e&&null!=f&&(c=this.Sk.get(e+":"+f));if(b&&!c){var g=a.la,k=a.tb();g&&k&&this.Sk.remove(g+":"+k)}c&&!b&&this.Fc.remove(c.getId());this.Fc.set(a.getId(),a);null!=e&&null!=f&&this.Sk.set(e+":"+f,a);this.mm||(this.mm=!0,this.eF());this.ve.Yh(a);Rf.O().ei=new Qf(a.cc,a.la)};d.uw=function(a){F(this.a,"Channel error for sink "+a);this.gn(a)};
d.gn=function(a){var b=this.Fc.get(a);if(b){F(this.a,"Removing sink "+a);this.Fc.remove(a);a=b.la;var c=b.tb();null!=a&&null!=c&&this.Sk.remove(a+":"+c);this.ve.Tq(b)}};d.c1=function(){var a=this.Fc.A();this.Fc.clear();this.Sk.clear();a.forEach(this.ve.Tq,this.ve)};d.sl=function(a){G(this.a,"Checking access to "+a.getId());return this.lA.$i(a).then(function(b){if(a.Gl){var c=4;b.audioOnly||(c|=1);a.Z2(c)}return!0},function(){return!1})};
d.er=function(){F(this.a,"Pruning inactive sinks.");Gc(this.fm(),function(a){this.hf.set(a.getId(),a);this.sl(a).then(function(b){b||this.gn(a.getId())},null,this).Ab(function(){this.hf.remove(a.getId())},this)},this)};d.W=function(a){return this.Fc.get(a,null)};d.GU=function(a,b){return this.Sk.get(a+":"+b)};d.HU=function(a){var b=[];Gc(this.fm(),function(c){Gi(c.Id(a))&&b.push(c)});return b};d.fm=function(){return this.Fc.jv()};d.Qc=function(a){this.ve.Qc(a)};d.kc=function(){return this.Fc.A()};
var Pi=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=2},Qi=function(a){this.hasSavedSinks=a};d=Ni.prototype;d.Ra=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a={};Gc(this.Fc.RC(),function(b){var c;c=this.Fc.get(b);c={id:c.getId(),ip:c.la,port:c.tb(),friendlyName:c.Tl(),modelName:c.cc,capabilities:c.Zc};a[b]=c},this);return[new Pi(a,this.tm),new Qi(this.mm)]};
d.vb=function(){var a=nf(this);a&&2==a.version&&(this.tm=a.networkIds,this.iF(a.sinkMap));if(a=of(this))this.mm=a.hasSavedSinks};d.iF=function(a){this.iE=0<Object.keys(a).length;for(var b in a){var c;c=a[b];var e=new Li("",c.friendlyName,c.modelName,c.capabilities,c.ip,c.port);e.Wd.id=c.id;c=e;this.W(c.getId())||this.qA(c,!1)}};
d.XB=function(){F(this.a,"Fetching networks state");this.gj&&yf(this.gj);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(a){for(var b=[],c=0;c<a.length;c++)"Connected"==a[c].ConnectionState&&b.push(a[c].GUID);this.u7(b.sort().join(","))}.bind(this))};
d.u7=function(a){F(this.a,"Update current network "+Ri(a));a!=this.og&&(this.gj&&(pf.remove(this.gj.Ra()),this.gj=null),a?(this.tm&&a!=this.tm?this.c1():this.er(),this.tm=this.og=a,this.gj=new Si(this,this.og)):this.og="")};var Ri=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},Si=function(a,b){this.Vc=a;this.og=b;qf(this)};Si.prototype.Ra=function(){return"cast.NetworkSink."+this.og};
Si.prototype.getData=function(){var a=null,b=this.Vc.getData();b&&(this.Vc.iE||0<this.Vc.kc().length)&&(a=b[0]);F(this.Vc.a,"Saving sink data for network "+Ri(this.og));return[null,a]};Si.prototype.vb=function(){F(this.Vc.a,"Restoring sink data for network "+Ri(this.og));var a=of(this);a&&2==a.version&&this.Vc.iF(a.sinkMap)};var Ti={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var Ui=function(){this.type="GET_STATUS";this.requestId=0};var Vi=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var Wi=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var Xi=function(a,b){this.requestId=a;this.e7=b;this.VJ=null};Xi.prototype.ww=function(){};var Yi=function(){this.Jb=new A};Yi.prototype.zz=function(a){this.Jb.set(a.requestId,a);a.VJ=setTimeout(this.QZ.bind(this,a),a.e7)};Yi.prototype.dn=function(a){var b=this.Jb.get(a);if(!b)return null;clearTimeout(b.VJ);this.Jb.remove(a);return b};Yi.prototype.uh=function(a){return this.Jb.get(a,null)};Yi.prototype.QZ=function(a){this.Jb.remove(a.requestId);a.ww()};var Zi=function(a){this.N6=a;this.hk=1E3*Math.floor(1E6*Math.random())};d=Zi.prototype;d.qB=function(){qf(this)};d.Op=function(){var a=this.hk++;0==a&&(a=this.hk++);return a};d.Ra=function(){return"IdGenerator."+this.N6};d.getData=function(){return[this.hk]};d.vb=function(){var a=nf(this);a&&(this.hk=a)};var $i=function(a,b){this.vc=a;this.Uc=b;this.ai=new Yi;this.vH=new Zi("cast.RequestIdGenerator")};$i.prototype.init=function(){this.vH.qB()};var aj=function(a,b,c,e){Xi.call(this,a,c);this.lb=b;this.sourceId=e};u(aj,Xi);aj.prototype.ww=function(){this.lb.reject(bj)};$i.prototype.Az=function(a,b,c){var e=this.vH.Op();a.requestId=e;a=J();b=new aj(e,a,q(b)&&0<b?b:6E5,c);this.ai.zz(b);return b};$i.prototype.qx=function(a){this.ai.dn(a.requestId)};$i.prototype.dn=function(a){return this.ai.dn(a)};
var bj=Error("Timeout"),dj=Error("Failed to send message");$i.prototype.sendRequest=function(a,b,c,e,f,g){if(!xi.hasOwnProperty(c))return I(Error("Custom namespace is not supported"));var k=this.Az(a,l(e)?e:3E3,f),p=k.lb;this.vc.ur(b,c,a,f||this.Uc,g).then(null,function(){this.qx(k);p.reject(dj)},this);return p.promise};
$i.prototype.sendMessage=function(a,b,c,e,f,g){var k=this.Az(a,l(e)?e:3E3,f),p=k.lb;this.vc.ur(b,c,a,f||this.Uc,g).then(function(){this.qx(k);p.resolve(!0)},function(){this.qx(k);p.reject(dj)},this);return p.promise};$i.prototype.B1=function(a,b){var c=new Vi(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,ui,a.requestSessionTimeout)};
$i.prototype.E1=function(a,b){return this.sendRequest(new Wi(a),b,ui)};var ej=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b};m("castApp.eventPage.Message",ej,void 0);var fj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};ej.DeviceData=fj;var gj=function(a,b){this.rc=a;this.$c=b;this.kj=new A;this.hh=new Sc;this.RE=0;this.XX=new A("serviceCheck",this.TV.bind(this),"startDeviceMonitor",this.aW.bind(this),"releaseDeviceMonitor",this.OV.bind(this));chrome.runtime.onMessage.addListener(this.JV.bind(this));chrome.runtime.onMessageExternal.addListener(this.DV.bind(this));this.se("serviceReady")};d=gj.prototype;d.a=C("castApp.eventPage.Service");d.tL=3E4;
d.ZV=function(){if(this.rA()){var a=new Sc;Gc(this.rc.fm(),function(b){var e=b.la;a.add(e);this.kj.Oa(e)||this.$c.sendRequest(new Ui,b,ui)}.bind(this));var b=!1;this.kj.ab().forEach(function(c){a.contains(c)||(this.kj.remove(c),b=!0)}.bind(this));b&&this.mt()}};
d.wV=function(a,b){if(this.rA()&&xi.hasOwnProperty(b.namespace_)&&(a=a.la)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.kj.get(a);this.kj.set(a,new fj(a,b,e));c&&c.appId===b||this.mt()}};
d.rA=function(){if(0===this.hh.N())return!1;var a=t();if(a-this.RE>this.tL){this.RE=a;var b=[];chrome.extension.getViews().forEach(function(a){(a=a["castApp.eventPage.Message.OriginID"])&&b.push(a)}.bind(this));this.hh=this.hh.uE(b);F(this.a,"monitor client count: "+this.hh.N())}return 0<this.hh.N()};
d.JV=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.XX.get(a.subtype);if(!e)return!1;if(!a.originId)return hb("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){D(this.a,"Error while handling request",g)}return!1};d.se=function(a,b){a=new ej(a,b);F(this.a,"Sending message: "+JSON.stringify(a));chrome.runtime.sendMessage(a)};d.TV=function(){this.se("serviceReady")};
d.aW=function(a){F(this.a,"Registering monitor client: "+a.originId);this.hh.add(a.originId);this.mt();this.T0()};d.OV=function(a){F(this.a,"Unregistering monitor client: "+a.originId);this.hh.remove(a.originId)};d.mt=function(){var a=this.kj.A();this.se("devices",a)};d.T0=function(){this.rc.refresh();this.rc.kc().forEach(function(a){this.$c.sendRequest(new Ui,a,ui)}.bind(this))};
d.DV=function(a,b,c){switch(a.type){case "handshake":c(new ri("handshake"));break;case "launch":b=b.tab&&q(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome-extension://"+chrome.runtime.id+"/cast_setup/"+a.entryPoint+".html"})}};chrome.cast.Ae={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Ae,void 0);chrome.cast.fo={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.fo,void 0);chrome.cast.Af={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.Af,void 0);chrome.cast.Be={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.Be,void 0);chrome.cast.OL={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.OL,void 0);chrome.cast.YL={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.YL,void 0);chrome.cast.io={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.io,void 0);chrome.cast.cL={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.cL,void 0);chrome.cast.il={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.il,void 0);chrome.cast.hz={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.hz,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.T7=!0;m("chrome.cast.usingPresentationApi",chrome.cast.T7,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.XL=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.XL,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.VK=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Ae.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.fo.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.VK,void 0);chrome.cast.eL=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.eL,void 0);
chrome.cast.$y=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.$y,void 0);chrome.cast.dL=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.dL,void 0);chrome.cast.gz=function(a,b,c){this.appId=a;this.capabilities=Ca(b)?b:[chrome.cast.Af.VIDEO_OUT,chrome.cast.Af.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.gz,void 0);chrome.cast.Js=function(a,b,c,e){this.label=a;this.friendlyName=b;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.io.CAST;this.displayStatus=this.isActiveInput=null};m("chrome.cast.Receiver",chrome.cast.Js,void 0);chrome.cast.PL=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.PL,void 0);
chrome.cast.kz=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.kz,void 0);chrome.cast.timeout=new chrome.cast.kz;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.UK="auto-join";chrome.cast.dz="cast-session_";chrome.cast.media.hl={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.hl,void 0);chrome.cast.media.wd={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.wd,void 0);chrome.cast.media.ho={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.ho,void 0);
chrome.cast.media.Ks={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.Ks,void 0);chrome.cast.media.QL={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.QL,void 0);chrome.cast.media.iz={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.iz,void 0);
chrome.cast.media.kL={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.kL,void 0);chrome.cast.media.hM={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.hM,void 0);chrome.cast.media.eM={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.eM,void 0);
chrome.cast.media.aM={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.aM,void 0);chrome.cast.media.fM={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.fM,void 0);
chrome.cast.media.bM={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.bM,void 0);chrome.cast.media.cM={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.cM,void 0);chrome.cast.media.iL=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.iL,void 0);chrome.cast.media.BL=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.BL,void 0);chrome.cast.media.DL=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.DL,void 0);chrome.cast.media.WL=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.WL,void 0);
chrome.cast.media.ZL=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.ZL,void 0);chrome.cast.media.kM=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.kM,void 0);chrome.cast.media.nL=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.nL,void 0);
chrome.cast.media.gL=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.gL,void 0);chrome.cast.media.hL=function(){this.metadataType=this.type=chrome.cast.media.wd.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.hL,void 0);
chrome.cast.media.vL=function(){this.metadataType=this.type=chrome.cast.media.wd.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.vL,void 0);chrome.cast.media.iM=function(){this.metadataType=this.type=chrome.cast.media.wd.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.iM,void 0);chrome.cast.media.wL=function(){this.metadataType=this.type=chrome.cast.media.wd.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.wL,void 0);
chrome.cast.media.CL=function(){this.metadataType=this.type=chrome.cast.media.wd.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.CL,void 0);chrome.cast.media.uL=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.iz.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.uL,void 0);chrome.cast.media.FL=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.FL,void 0);chrome.cast.media.aL="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.aL,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Qa=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Qa;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.Ok=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.Ok;chrome.cast.media.timeout.$t=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.$t;chrome.cast.media.timeout.x0=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.x0;
chrome.cast.media.gM=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.gM,void 0);chrome.cast.media.dM=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.dM,void 0);chrome.cast.media.HL=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Ks.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.HL,void 0);chrome.cast.media.EL=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.EL,void 0);chrome.cast.media.LL=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.LL,void 0);chrome.cast.media.GL=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.GL,void 0);
chrome.cast.media.KL=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.KL,void 0);chrome.cast.media.IL=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.IL,void 0);
chrome.cast.media.JL=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.JL,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.ho.IDLE;this.currentTime=0;this.ME=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Ks.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.Qa=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.Qa;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;
chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.Ok=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.Ok;chrome.cast.media.u.prototype.$t=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.$t;chrome.cast.media.u.prototype.A0=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.A0;
chrome.cast.media.u.prototype.y0=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.y0;chrome.cast.media.u.prototype.K0=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.K0;chrome.cast.media.u.prototype.F0=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.F0;chrome.cast.media.u.prototype.E0=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.E0;
chrome.cast.media.u.prototype.B0=function(a){this.Iu(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.B0;chrome.cast.media.u.prototype.J0=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.J0;chrome.cast.media.u.prototype.H0=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.H0;chrome.cast.media.u.prototype.G0=function(a){this.Iu(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.G0;
chrome.cast.media.u.prototype.I0=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.I0;chrome.cast.media.u.prototype.D0=function(a,b,c,e){a=this.Iu(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.Be.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.D0;chrome.cast.media.u.prototype.V6=function(a){return-1<this.supportedMediaCommands.indexOf(a)};
chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.V6;chrome.cast.media.u.prototype.WR=function(){if(this.playerState==chrome.cast.media.ho.PLAYING&&0<=this.ME){var a=(t()-this.ME)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.WR;chrome.cast.media.u.prototype.Vs=function(){};
chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Vs;chrome.cast.media.u.prototype.sx=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.sx;chrome.cast.media.u.prototype.Iu=function(a){return pb(this.items,function(b){return b.itemId==a})};var hj=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var ij=function(a){this.$c=a;this.a=C("mr.cast.ReceiverStatusQuerier")};ij.prototype.B6=function(a){return(new Sf(r(this.w0,this,a),3500,5)).zr(2).start().na(function(b){F(this.a,"Failed to get receiver status from "+a.getId());throw b;},this)};ij.prototype.w0=function(a){F(this.a,"Query receiver status: "+a.getId());return this.$c.sendRequest(new Ui,a,ui)};var jj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.T=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.hz.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.T,void 0);chrome.cast.T.prototype.g5=function(a,b,c){a=new jj(new chrome.cast.Volume(a,null),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverVolumeLevel=chrome.cast.T.prototype.g5;
chrome.cast.T.prototype.f5=function(a,b,c){a=new jj(new chrome.cast.Volume(null,a),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverMuted=chrome.cast.T.prototype.f5;chrome.cast.T.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.T.prototype.leave=chrome.cast.T.prototype.leave;chrome.cast.T.prototype.stop=function(){};chrome.cast.T.prototype.stop=chrome.cast.T.prototype.stop;chrome.cast.T.prototype.sendMessage=function(){};
chrome.cast.T.prototype.sendMessage=chrome.cast.T.prototype.sendMessage;chrome.cast.T.prototype.Vs=function(){};chrome.cast.T.prototype.addUpdateListener=chrome.cast.T.prototype.Vs;chrome.cast.T.prototype.sx=function(){};chrome.cast.T.prototype.removeUpdateListener=chrome.cast.T.prototype.sx;chrome.cast.T.prototype.BM=function(){};chrome.cast.T.prototype.addMessageListener=chrome.cast.T.prototype.BM;chrome.cast.T.prototype.AM=function(){};chrome.cast.T.prototype.addMediaListener=chrome.cast.T.prototype.AM;
chrome.cast.T.prototype.n1=function(){};chrome.cast.T.prototype.removeMediaListener=chrome.cast.T.prototype.n1;chrome.cast.T.prototype.o1=function(){};chrome.cast.T.prototype.removeMessageListener=chrome.cast.T.prototype.o1;chrome.cast.T.prototype.uX=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.loadMedia=chrome.cast.T.prototype.uX;chrome.cast.T.prototype.C0=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.queueLoad=chrome.cast.T.prototype.C0;var mj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=kj(a);a=new chrome.cast.T(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||lj(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},nj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.Af.VIDEO_OUT);a&2&&b.push(chrome.cast.Af.VIDEO_IN);a&4&&b.push(chrome.cast.Af.AUDIO_OUT);a&8&&b.push(chrome.cast.Af.AUDIO_IN);a&32&&b.push(chrome.cast.Af.MULTIZONE_GROUP);return b},kj=function(a){return new chrome.cast.Js(a.getId(),a.Tl(),nj(a.Zc))},oj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f=0;f<c.length;f++)if(!e.some(function(a){return a.name==c[f].name}))return!0;
return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},pj=function(a){Ca(a)?a.forEach(pj):Fa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Fa(a[b])||Ca(a[b]))&&pj(a[b])})},qj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},rj=["MultizoneLeader","MultizoneFollower"],lj=function(a){return null!==a&&"MultizoneLeader"==a.appId},sj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var tj=function(a){this.$c=a;this.a=C("mr.cast.SessionLauncher")};tj.prototype.dw=function(a,b){kh("MediaRouter.Cast.Session.Type",0,yi);return this.$c.B1(a,b).then(r(this.FV,this,b),function(a){a&&bj==a?Fi(1):Fi(0);return I(a)})};tj.prototype.FV=function(a,b){G(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Fi(2),Error(b.reason);a=mj(a,b.status);F(this.a,"Launched session: "+a.sessionId);return a};var uj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var vj=function(a,b){this.sg=a;this.Cb=b;this.Vj=[];this.ai=new Yi},wj=function(a,b){Xi.call(this,a,3E4);this.lb=b};u(wj,Xi);wj.prototype.ww=function(){this.lb.resolve(!1)};d=vj.prototype;d.a=C("mr.cast.ApiMessenger");d.Rp=function(a){return(a=this.Cb.dd(a))?a.routeId:null};d.listen=function(a,b){this.Vj[a]=b};d.Fk=function(a,b,c){G(this.a,"Sending to "+b);G(this.a,JSON.stringify(c));c.clientId=b;this.sg.pP(a,c)};
d.sf=function(a,b){var c=this.Cb.dd(a);c&&c.Bv?this.Fk(c.routeId,a,b):this.connect(a).then(function(c){c?(c=this.Rp(a))?this.Fk(c,a,b):E(this.a,"No route for "+a):E(this.a,"No connected client "+a)},null,this)};d.Lm=function(a){G(this.a,"App "+a);var b=this.Rp(a);if(b){if(b=this.ai.dn(b))(a=this.Cb.dd(a))?(a.Bv=!0,b.lb.resolve(!0)):b.lb.resolve(!1)}else E(this.a,"No route for client "+a)};
d.mY=function(a){G(this.a,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.Lm(b):this.Rp(b)?(b=this.Vj[a.type])&&b(a):E(this.a,"No route for "+b)};d.connect=function(a){if(this.JW(a))return H(!0);var b=this.Rp(a);if(!b)return E(this.a,"No route for client "+a),H(!1);if(a=this.ai.uh(b))return a.lb.promise;var c=J();a=new wj(b,c);this.ai.zz(a);return c.promise};d.JW=function(a){a=this.Cb.dd(a);return null!=a&&a.Bv};var xj=function(a,b){this.oj=this.ye=this.Bg="";this.jb=null;this.Sf=this.pd="";this.hd=this.UW=!1;var c;a instanceof xj?(this.hd=l(b)?b:a.hd,this.Mr(a.Bg),this.fy(a.im()),this.Jk(a.Wf()),this.Nk(a.tb()),this.Eg(a.pd),this.Ir(a.kf.clone()),this.Cr(a.Sf)):a&&(c=String(a).match(gf))?(this.hd=!!b,this.Mr(c[1]||"",!0),this.fy(c[2]||"",!0),this.Jk(c[3]||"",!0),this.Nk(c[4]),this.Eg(c[5]||"",!0),this.Ir(c[6]||"",!0),this.Cr(c[7]||"",!0)):(this.hd=!!b,this.kf=new yj(null,null,this.hd))};d=xj.prototype;
d.toString=function(){var a=[],b=this.Bg;b&&a.push(zj(b,Aj,!0),":");var c=this.Wf();if(c||"file"==b)a.push("//"),(b=this.im())&&a.push(zj(b,Aj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.tb(),null!=c&&a.push(":",String(c));if(c=this.pd)this.qv()&&"/"!=c.charAt(0)&&a.push("/"),a.push(zj(c,"/"==c.charAt(0)?Bj:Cj,!0));(c=this.UR())&&a.push("?",c);(c=this.Sf)&&a.push("#",zj(c,Dj));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.kW();c?b.Mr(a.Bg):c=a.lW();c?b.fy(a.im()):c=a.qv();c?b.Jk(a.Wf()):c=a.iW();var e=a.pd;if(c)b.Nk(a.tb());else if(c=a.gE()){if("/"!=e.charAt(0))if(this.qv()&&!this.gE())e="/"+e;else{var f=b.pd.lastIndexOf("/");-1!=f&&(e=b.pd.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ma(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var p=f[k++];"."==p?e&&k==f.length&&g.push(""):".."==p?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(p),e=!0)}e=g.join("/")}else e=f}c?b.Eg(e):c=a.jW();c?b.Ir(a.uR()):c=a.gW();c&&b.Cr(a.Sf);return b};d.clone=function(){return new xj(this)};d.Mr=function(a,b){this.kh();if(this.Bg=b?Ej(a,!0):a)this.Bg=this.Bg.replace(/:$/,"");return this};d.kW=function(){return!!this.Bg};d.im=function(){return this.ye};d.fy=function(a,b){this.kh();this.ye=b?Ej(a):a;return this};d.lW=function(){return!!this.ye};d.Wf=function(){return this.oj};
d.Jk=function(a,b){this.kh();this.oj=b?Ej(a,!0):a;return this};d.qv=function(){return!!this.oj};d.tb=function(){return this.jb};d.Nk=function(a){this.kh();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.jb=a}else this.jb=null;return this};d.iW=function(){return null!=this.jb};d.Eg=function(a,b){this.kh();this.pd=b?Ej(a,!0):a;return this};d.gE=function(){return!!this.pd};d.jW=function(){return""!==this.kf.toString()};
d.Ir=function(a,b){this.kh();a instanceof yj?(this.kf=a,this.kf.Ux(this.hd)):(b||(a=zj(a,Fj)),this.kf=new yj(a,null,this.hd));return this};d.UR=function(){return this.kf.toString()};d.uR=function(){return this.kf.f7()};d.Cr=function(a,b){this.kh();this.Sf=b?Ej(a):a;return this};d.gW=function(){return!!this.Sf};d.kh=function(){if(this.UW)throw Error("Tried to modify a read-only Uri");};d.Ux=function(a){this.hd=a;this.kf&&this.kf.Ux(a);return this};
var Ej=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},zj=function(a,b,c){return n(a)?(a=encodeURI(a).replace(b,Gj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Gj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Aj=/[#\/\?@]/g,Cj=/[\#\?:]/g,Bj=/[\#\?]/g,Fj=/[\#\?@]/g,Dj=/#/g,yj=function(a,b,c){this.Ha=this.eb=null;this.Rf=a||null;this.hd=!!c};
yj.prototype.Re=function(){if(!this.eb&&(this.eb=new A,this.Ha=0,this.Rf)){var a=this;jf(this.Rf,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var Hj=function(a,b,c){b=Nc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new yj(null,null,c);a=Mc(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];Ca(g)?c.wJ(f,g):c.add(f,g)}return c};d=yj.prototype;d.N=function(){this.Re();return this.Ha};
d.add=function(a,b){this.Re();this.Sj();a=this.zj(a);var c=this.eb.get(a);c||this.eb.set(a,c=[]);c.push(b);this.Ha+=1;return this};d.remove=function(a){this.Re();a=this.zj(a);return this.eb.Oa(a)?(this.Sj(),this.Ha-=this.eb.get(a).length,this.eb.remove(a)):!1};d.clear=function(){this.Sj();this.eb=null;this.Ha=0};d.Db=function(){this.Re();return 0==this.Ha};d.Oa=function(a){this.Re();a=this.zj(a);return this.eb.Oa(a)};d.bj=function(a){var b=this.A();return sb(b,a)};
d.ab=function(){this.Re();for(var a=this.eb.A(),b=this.eb.ab(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.A=function(a){this.Re();var b=[];if(n(a))this.Oa(a)&&(b=Bb(b,this.eb.get(this.zj(a))));else{a=this.eb.A();for(var c=0;c<a.length;c++)b=Bb(b,a[c])}return b};d.set=function(a,b){this.Re();this.Sj();a=this.zj(a);this.Oa(a)&&(this.Ha-=this.eb.get(a).length);this.eb.set(a,[b]);this.Ha+=1;return this};
d.get=function(a,b){a=a?this.A(a):[];return 0<a.length?String(a[0]):b};d.wJ=function(a,b){this.remove(a);0<b.length&&(this.Sj(),this.eb.set(this.zj(a),y(b)),this.Ha+=b.length)};d.toString=function(){if(this.Rf)return this.Rf;if(!this.eb)return"";for(var a=[],b=this.eb.ab(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.A(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.Rf=a.join("&")};d.f7=function(){return Ej(this.toString())};
d.Sj=function(){this.Rf=null};d.clone=function(){var a=new yj;a.Rf=this.Rf;this.eb&&(a.eb=this.eb.clone(),a.Ha=this.Ha);return a};d.zj=function(a){a=String(a);this.hd&&(a=a.toLowerCase());return a};d.Ux=function(a){a&&!this.hd&&(this.Re(),this.Sj(),this.eb.forEach(function(a,c){var e=c.toLowerCase();c!=e&&(this.remove(c),this.wJ(e,a))},this));this.hd=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Pc(arguments[b],function(a,b){this.add(b,a)},this)};var Ij=function(a,b,c,e,f,g,k,p){this.Zs=a;this.ad=b||null;this.zo=c||null;this.$o=e||null;this.yq=l(f)?f:null;this.$s=g||null;this.eB=k||null;this.xv=p||!1},Jj=/(^\w+)(?:\(([\w,\ ]*)\))?$/,Kj=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},Lj=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:mb(x(a,function(a){a=Kj(a,"__castAppId__");if(!a)return null;a=a.match(Jj);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},Mj=function(a){return Kj(a,"__castClientId__")};d=Ij.prototype;d.Nl=function(){return x(this.Zs,function(a){return a.appId})};d.$B=function(){return this.$s};d.Xb=function(){return this.ad};d.wu=function(){return this.zo?this.zo:chrome.cast.Ae.TAB_AND_ORIGIN_SCOPED};d.vR=function(){return this.$o?this.$o:chrome.cast.fo.CREATE_SESSION};d.GS=function(){return null==this.yq?chrome.cast.timeout.requestSession:this.yq};
d.toString=function(){var a=new xj;a.Mr("https");a.Jk("google.com");a.Eg("/cast");var b=[];v(this.Zs,function(a){var e="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(e=e+"("+a.capabilities.join(","),e+=")");b.push(e)});this.ad&&b.push("__castClientId__="+this.ad);this.zo&&b.push("__castAutoJoinPolicy__="+this.zo);this.$o&&b.push("__castDefaultActionPolicy__="+this.$o);null!=this.yq&&b.push("__castLaunchTimeout__="+this.yq);this.$s&&b.push("__dialAppName__="+this.$s);this.eB&&b.push("__dialPostData__="+
this.eB);this.xv&&b.push("__castInvisibleSender__=true");a.Cr(b.join("/"));return a.toString()};d.$W=function(a){var b=this.Nl(),c=Nj(a);return nb(b,function(a){return sb(c,a)})};
var Oj=function(a){var b=(new xj(a)).Sf;a=Lj(b);if(!a||0==a.length)return null;var c=Mj(b),e=Kj(b,"__castAutoJoinPolicy__"),f=Kj(b,"__castDefaultActionPolicy__"),g;g=Kj(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=Kj(b,"__dialAppName__"),p=Kj(b,"__dialPostData__"),b=Kj(b,"__castInvisibleSender__");return new Ij(a,c,e,f,g,k,p,null===b?null:"true"==b)},Nj=function(a){return(a=Oj(a))?a.Nl():null},Pj=function(a){return(a=Oj(a))?a.Xb():null};var Qj=function(a,b,c,e,f,g){this.nf=a;this.V=b;this.Cb=c;this.ja=e;this.vc=f;this.sg=g;this.Hc=new vj(g,c);this.O0=new ij(this.nf);this.I2=new tj(this.nf)};d=Qj.prototype;d.a=C("mr.cast.ApiHandler");d.init=function(){this.Cb.init();this.Hc.listen("v2_message",this.UZ.bind(this));this.Hc.listen("app_message",this.rY.bind(this));this.Hc.listen("leave_session",this.TY.bind(this))};d.Qd=function(a,b){this.Hc.mY(b)};
d.Bx=function(a,b,c,e){a=this.ja.lC(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&this.WH(a,b)},this)};d.WH=function(a,b){b.clientId=a;this.Hc.sf(a,b)};d.ZH=function(a,b,c){b={receiver:kj(b),action:c};this.WH(a,new uj("receiver_action",b))};
d.UZ=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.cv(c);if(e)if(c=this.ja.BD(c))if(c=this.V.W(c))switch(b.type){case "STOP":this.oY(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.lY(a,c,e);break;case "SET_VOLUME":this.nY(a,c);break;default:E(this.a,"Unknown request")}else this.Ek(a,
chrome.cast.Be.INVALID_PARAMETER,"No receiver");else this.Ek(a,chrome.cast.Be.INVALID_PARAMETER,"No sink ID");else this.Ek(a,chrome.cast.Be.INVALID_PARAMETER,"Unknown session ID")}else this.Ek(a,chrome.cast.Be.INVALID_PARAMETER,"No session ID")};d.Ek=function(a,b,c){b=new chrome.cast.Error(b,c);this.Ax(a,b)};d.Ax=function(a,b){this.Hc.sf(a.clientId,new uj("error",b,a.sequenceNumber))};
d.oY=function(a,b){var c=a.message;jh("MediaRouter.Cast.Session.End");var e=c.sessionId,f=this.ja.Md(e);f&&(f.sq=!0);this.nf.sendRequest(c,b,ui,a.timeoutMillis,a.clientId).Ab(function(){this.rx(e,a)},this)};d.lY=function(a,b,c){var e=a.message,f=e.type;f in Ti&&(e.type=Ti[f]);this.nf.sendRequest(e,b,vi,a.timeoutMillis,a.clientId,c.transportId).then(function(b){this.VG(c,b);this.Hc.sf(a.clientId,new uj("v2_message",b,a.sequenceNumber))},function(b){this.Ax(a,b)},this)};
d.nY=function(a,b){var c=a.message;delete c.sessionId;this.nf.sendRequest(c,b,ui,a.timeoutMillis,a.clientId).then(function(){this.Hc.sf(a.clientId,new uj("v2_message",null,a.sequenceNumber))},function(b){this.Ax(a,b)},this)};
d.rY=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.BD(c);e?(e=this.V.W(e))?(c=this.ja.cv(c),qb(c.namespaces,function(a){return a.name==b.namespaceName})?this.vc.ur(e,b.namespaceName,b.message,a.clientId,c.transportId).then(function(){this.Hc.sf(a.clientId,new uj("app_message",null,a.sequenceNumber))},function(){this.Ek(a,chrome.cast.Be.CHANNEL_ERROR,"Channel to receiver not available")},this):this.Ek(a,chrome.cast.Be.INVALID_PARAMETER,"Invalid namespace")):E(this.a,"No receiver from sinkId"):
E(this.a,"No sinkId from sessionId")}else E(this.a,"No sessionId")};d.q1=function(a){a.sd.slice().forEach(function(a){this.sg.xU(a)||this.sg.xk(a,!0)}.bind(this))};d.Tq=function(a){(a=this.ja.bm(a))&&a.session&&this.rx(a.session.sessionId)};
d.TY=function(a){F(this.a,"Leave session");var b=a.message,c=this.ja.Md(b);if(c){var e=a.clientId,f=this.Cb.dd(e);if(f){var g=[],k=[],p=f.tabId,w=f.origin,B=f.autoJoinPolicy;c.Je.forEach(function(a){var b=this.Cb.dd(a);B==chrome.cast.Ae.TAB_AND_ORIGIN_SCOPED&&p==b.tabId&&w==b.origin||B==chrome.cast.Ae.ORIGIN_SCOPED&&w==b.origin?g.push(a):k.push(a)},this);this.Hc.sf(e,new uj("leave_session",null,a.sequenceNumber));g.forEach(function(a){this.Hc.sf(a,new uj("disconnect_session",b))},this);c.Je=k}else E(this.a,
"No client record")}else E(this.a,"No session")};d.ZG=function(a,b){qj(a,vi)&&this.nf.sendRequest(new Ui,b,vi,void 0,void 0,a.transportId).na(ya)};d.$G=function(a,b){var c=a.getId();F(this.a,"Query status for "+c);this.O0.B6(a).then(function(e){this.nG(c,e);b&&(e=this.ja.Tp(c))&&this.ZG(e,a)},ya,this)};d.AZ=function(a,b){xi.hasOwnProperty(b.namespace_)?this.xZ(a,b):this.wZ(a,b)};
d.fX=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.vc.uD()||null!=this.Cb.dd(a))return!0;F(this.a,"Invalid destination "+a);return!1};
d.xZ=function(a,b){G(this.a,"Cast message: "+JSON.stringify(b));if(this.fX(b))if(b.namespace_==wi)(a=this.ja.bm(a))&&a.sd.forEach(function(a){this.sg.oP(a,b)}.bind(this));else{var c=JSON.parse(b.data),e=this.MV(c),e=e?e.sourceId:void 0;switch(c.type){case "RECEIVER_STATUS":this.nG(a,c);break;case "MEDIA_STATUS":this.zZ(a,b,e)}}else this.vc.DA(a,b.destinationId,b.sourceId,!0)};
d.MV=function(a){var b=this.nf.dn(a.requestId);if(!b)return null;var c=b.lb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId,c.reject(new chrome.cast.Error(chrome.cast.Be.SESSION_ERROR,a.reason||a.type,a));default:c.resolve(a)}return b};
d.wZ=function(a,b){G(this.a,"App message: "+JSON.stringify(b));if(a=this.ja.Tp(a)){var c=[],c="*"==b.destinationId?this.ja.lC(a.sessionId):[b.destinationId],e=new hj(a.sessionId,b.namespace_,b.data);c.forEach(function(a){this.Hc.sf(a,new uj("app_message",e))},this)}else E(this.a,"No session for incoming app message")};
var Rj=function(a,b){a.forEach(function(a){a.sessionId=b;var e=a.supportedMediaCommands,f=[];e&1&&f.push(chrome.cast.media.hl.PAUSE);e&2&&f.push(chrome.cast.media.hl.SEEK);e&4&&f.push(chrome.cast.media.hl.STREAM_VOLUME);e&8&&f.push(chrome.cast.media.hl.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=Qj.prototype;d.VG=function(a,b){a=a.sessionId;b.sessionId=a;this.ja.x5(a,Rj(b.status,a))};d.eZ=function(a,b,c){this.Hc.sf(c,new uj("new_session",a));this.ZG(a,b)};
d.en=function(a){if(a=this.ja.Tp(a)){a=a.sessionId;var b=this.ja.Md(a);b&&b.sq||this.rx(a)}};d.rx=function(a,b){this.Bx(a,new uj("remove_session",a,b?b.sequenceNumber:void 0),b);(b=this.ja.Md(a))&&this.q1(b);this.ja.r1(a)};
d.nG=function(a,b){G(this.a,"Receiver status for "+a);var c=b.status;if(c)if(b=this.V.W(a)){var c=mj(b,c),e=this.ja.bm(a);e?c?c.sessionId==e.session.sessionId?this.YV(e,c):(this.$D(a),this.sg.ce(null,b,null,c)):this.$D(a):c&&this.sg.ce(null,b,null,c)}else jh("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),E(this.a,"Got message from receiver "+a+", but sink is no longer available.")};
d.YV=function(a,b){var c=a.session;oj(c,b)&&(G(this.a,"Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.sg.F7(a),this.Bx(c.sessionId,new uj("update_session",c),void 0))};d.$D=function(a){this.en(a,"receiver-app-end");Di(1)};d.zZ=function(a,b,c){if(a=this.ja.Tp(a))if(b=JSON.parse(b.data))this.VG(a,b),this.Bx(b.sessionId,new uj("v2_message",b),void 0,c)};
d.eO=function(a,b){var c=nj(b.Zc);return(b=qb(a.Zs,function(a){return ob(a.capabilities,function(a){return sb(c,a)})}))?b.appId:a.Nl()[0]};d.dw=function(a,b){var c=Oj(a);if(!c)return I(Error("Invalid source "+a));a=this.eO(c,b);var c=c.GS(),e=new bh("MediaRouter.Cast.Session.Launch");return this.I2.dw(new chrome.cast.gz(a,void 0,c),b).then(function(a){e.end("Success");return H(a)},function(a){e.end("Failure");return I(a)},this)};var Sj=C("mr.RuntimeErrorUtils"),Tj=function(){chrome.runtime.lastError&&Sj.IB(chrome.runtime.lastError.message||"unknown runtime error")};var Uj=function(){this.a=C("mr.cast.ChannelFactory");this.Ow=new A;this.Pw=new A;this.Sm=new A};d=Uj.prototype;d.$i=function(a,b){var c=a.getId(),e=a.la+":"+a.tb(),f=this.Ow.get(c);if(f){if(this.Sm.get(c)==e)return G(this.a,"Using pending creation to "+c),f;F(this.a,"Device "+c+" IP changed from "+this.Sm.get(a.getId())+" to "+e);this.mM(a)}a=this.tP(a,b).then(function(a){this.Ct(c);return a},function(a){e==this.Sm.get(c)&&this.Ct(c);return I(a)},this);this.Ow.set(c,a);this.Sm.set(c,e);return a};
d.mM=function(a){a=a.getId();G(this.a,"Aborting connection to device "+a);var b=this.Pw.get(a);b&&b.abort();this.Ct(a)};d.Ct=function(a){this.Ow.remove(a);this.Pw.remove(a);this.Sm.remove(a)};d.tP=function(a,b){if(1===b)return this.AG(a);var c=q(b)&&1<b?b:3;b=new Sf(r(this.AG,this,a),1E3,c);this.Pw.set(a.getId(),b);return b.zr(1.5).start().then(null,function(b){F(this.a,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return I(b)},this)};
d.AG=function(a){var b=Vj++;F(this.a,"Connecting to (id "+b+") "+a.getId());var c=new bh("MediaRouter.Cast.Mdns.Channel.Open");return this.WZ(a).then(function(a){F(this.a,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){F(this.a,"Channel did not open (id "+b+").");c.end("Failure");return I(a)},this)};var Vj=0;
Uj.prototype.WZ=function(a){a={ipAddress:a.la,port:a.tb(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};F(this.a,"Opening channel to "+JSON.stringify(a));var b=J();chrome.cast.channel.open(a,r(function(a){Tj();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this)),b.reject(Error(a.errorState)))},this));return b.promise};var Wj=function(a,b,c,e){return{namespace_:a,data:n(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var Yj=function(a){this.type="CONNECT";this.origin={};this.userAgent=hc;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:pi,platform:Xj(),systemVersion:b,connectionType:1};this.connType=a?0:2},Xj=function(){switch(Wh()?"ChromeOS":dd?"Windows":cd?"Mac":ed?"Linux":"Other"){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Zj=function(){this.ze=new A};za(Zj);d=Zj.prototype;d.init=function(){qf(this)};d.Ew=function(a,b,c,e){this.CA(a,b,c,!1);var f=Wj(ti,new Yj(e),b,c);chrome.cast.channel.send(a,f,r(this.TB,this));this.ze.set(this.Nv(a,b,c),e)};d.CA=function(a,b,c,e){if(this.kE(a,b,c)){var f=0;this.ze.forEach(function(a,b){b=b.split("#")[2];a&&b==c&&f++});if(e||1<f)this.rH(a,b,c),b=Wj(ti,{type:"CLOSE"},b,c),chrome.cast.channel.send(a,b,r(this.TB,this))}};d.rH=function(a,b,c){this.ze.remove(this.Nv(a,b,c))};
d.t1=function(a){this.ze.ab().forEach(function(b){b.split("#")[0]==a.channelId.toString()&&this.ze.remove(b)},this)};d.fY=function(a,b){this.ze.forEach(function(c,e){var f=e.split("#");f[0]==a.channelId.toString()&&(this.Ew(b,f[1],f[2],c),this.ze.remove(e))},this)};d.MP=function(a,b,c){this.kE(a,b,c)||this.Ew(a,b,c,0==c.indexOf("receiver-0"))};d.kE=function(a,b,c){return this.ze.Oa(this.Nv(a,b,c))};d.TB=function(){Tj()};d.Nv=function(a,b,c){return[a.channelId,b,c].join("#")};
var ak=function(a){this.GK=a};Zj.prototype.Ra=function(){return"cast.VirtualConnectionManager"};Zj.prototype.getData=function(){var a=this.ze.b();return[new ak(a)]};Zj.prototype.vb=function(){var a=nf(this);if(a)for(var b in a.GK)this.ze.set(b,a.GK[b])};var bk=function(a,b){this.zt=b;this.Uc=a;this.a=C("mr.cast.ChannelService");this.wg=new A;this.Hf=new A;this.Gi=Zj.O();this.WN=new Uj;this.W=null};d=bk.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(r(this.yY,this));chrome.cast.channel.onError.addListener(r(this.wY,this));this.Gi.init();qf(this)};d.uD=function(){return this.Uc};d.ur=function(a,b,c,e,f){var g=e||this.Uc,k=f||"receiver-0";return this.$i(a).then(function(a){return this.B2(a,b,c,g,k)},null,this)};
d.XZ=function(a,b,c,e){return this.$i(a).then(function(a){this.Gi.Ew(a,b,c,e)},null,this)};d.DA=function(a,b,c,e){(a=this.wg.get(a))&&this.Gi.CA(a,b,c,e)};
d.yY=function(a,b){var c=this.Hf.get(a.channelId);if(c){var e=this.W(c);if(e){if(xi.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.Gi.rH(a,b.destinationId,b.sourceId);return}F(this.a,"Got message "+(c.type||c.responseType)+" from "+e.getId())}else F(this.a,"Got message in "+b.namespace_+" from "+e.getId());this.zt.xY(e,b)}else E(this.a,"Receiver "+c+" not found.")}else E(this.a,"This message is from unknown receiver.")};
d.EA=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this));var b=this.Hf.get(a.channelId);b&&(this.Hf.remove(a.channelId),this.wg.remove(b))};d.wY=function(a,b){E(this.a,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.vM(b.errorState,b);this.BA(a)};
d.vM=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}E(this.a,"Channel error code: "+a);kh("MediaRouter.Cast.Channel.Error",a,Ci)};d.BA=function(a){var b=this.Hf.get(a.channelId);this.EA(a);if(b){var c=this.W(b);c&&this.$i(c).then(function(b){F(this.a,"Re-connected to receiver: "+c.getId());this.Gi.fY(a,b);this.zt.zY(c)},function(){F(this.a,"Failed to re-connect to receiver: "+c.getId());this.Gi.t1(a);this.zt.uw(c,a.errorState)},this)}};
d.$i=function(a){var b=a.getId(),c=this.wg.get(b);return c&&"open"==c.readyState?H(c):this.WN.$i(a).then(function(a){if(this.Hf.Oa(a.channelId))return a;this.wg.get(b)&&(E(this.a,"Duplicate channel to a receiver "+b),this.EA(this.wg.get(b)));F(this.a,"Connected to: "+b);this.wg.set(b,a);this.Hf.set(a.channelId,b);return a},null,this)};
d.B2=function(a,b,c,e,f){this.Gi.MP(a,e,f);pj(c);var g=Wj(b,c,e,f);F(this.a,"Channel is sending message");G(this.a,"....message was: "+JSON.stringify(g));return new ie(function(b,c){chrome.cast.channel.send(a,g,r(function(a){Tj();a.errorState?(c(Error("Failed to send message")),this.BA(a)):b(!0)},this))},this)};var ck=function(a,b){this.N0=a;this.XN=b};bk.prototype.Ra=function(){return"cast.ChannelService"};bk.prototype.getData=function(){return[new ck(this.wg.b(),this.Hf.b())]};
bk.prototype.vb=function(){var a=nf(this);a&&(this.wg.addAll(a.N0),this.Hf.addAll(a.XN))};var dk=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var ek=function(a,b){this.nf=a;this.V=b;this.Jb=new Sc;this.fc=new A};d=ek.prototype;d.a=C("mr.cast.AppDiscoveryService");d.init=function(){qf(this)};d.hx=function(a){var b=this.fc.get(a);b?b.jx++:this.fc.set(a,{jx:1});this.k2()};d.By=function(a){var b=this.fc.get(a);b&&(b.jx--,0<b.jx||(Gc(this.V.fm(),function(b){switch(b.Id(a)){case "available":b.yn(a,"available_rescan");break;case "unavailable":b.yn(a,"unavailable_rescan")}}),this.fc.remove(a)))};
d.k2=function(){F(this.a,"Scanning sinks for app availability");Gc(this.V.fm(),this.rn,this)};
d.rn=function(a){Gc(this.fc.RC(),function(b){var c;a:{switch(a.Id(b)){case "unknown":case "available_rescan":case "unavailable_rescan":c=!0;break a}c=!1}if(c){var e=a.getId()+":"+b;this.Jb.contains(e)||(this.Jb.add(e),(new Sf(this.$N.bind(this,a,b),5500,3)).zr(2).start().then(this.mK.bind(this,a,b),function(){D(this.a,"Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");this.mK(a,b,"unknown")},this).Ab(function(){this.Jb.remove(e)},this))}},this)};
d.mK=function(a,b,c){c!=a.Id(b)&&(F(this.a,b+" on "+a.getId()+" is "+c),a.yn(b,c),this.V.Qc(a))};
d.$N=function(a,b){var c=new dk;c.appId=[b];var e=new bh("MediaRouter.Cast.App.Availability");return this.nf.sendRequest(c,a,ui,5E3).then(function(a){e.end("Success");G(this.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(c){e.end("Failure");D(this.a,"checkAppAvailability_ failed for "+a.getId()+", appId "+b);throw c;},this)};
var fk=function(a){this.$0=a};ek.prototype.Ra=function(){return"cast.AppDiscoveryService"};ek.prototype.getData=function(){return[new fk(this.fc.b())]};ek.prototype.vb=function(){var a=nf(this);a&&this.fc.addAll(a.$0)};var gk=function(a,b){this.sinks=a;this.origins=b||null},hk=new gk([]);var ik=function(){},jk=function(a){if(!Ma(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=fb(b,"/",2);if(3!=b.length)return null;var c=fb(b[1],"-",1);if(2!=c.length)return null;var e=new ik;e.gka=a;e.PG=b[0];e.pja=c[0];e.Cka=c[1];e.Hg=b[2];return e};ik.prototype.da=function(){return this.Hg};var kk=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.ej=e},lk=function(a,b,c,e,f,g,k){return new kk("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var mk=function(a,b,c,e){return lk(c,"cast",b.getId(),a,e,"",null)};var nk=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.Bv=!1},ok=function(){this.kb=[]};d=ok.prototype;d.init=function(){qf(this)};d.N=function(){return this.kb.length};d.dd=function(a){return qb(this.kb,function(b){return b.clientId==a})};d.cg=function(a){return qb(this.kb,function(b){return b.routeId==a})};d.Qs=function(a,b,c,e,f,g){a=new nk(a,b,c,e,f,g);this.kb.push(a);return a};
d.ox=function(a){this.kb=mb(this.kb,function(b){return b.clientId!=a})};var pk=function(a){this.kr=a};ok.prototype.Ra=function(){return"cast.ClientRecords"};ok.prototype.getData=function(){return[new pk(this.kb)]};ok.prototype.vb=function(){var a=nf(this);a&&(this.kb=a.kr)};var qk=function(a){this.V=a},rk=function(a){var b=[];a.forEach(function(a){var e="Receiver-"+a.replace(/\./g,"_"),f=Rf.O().rl||8009;b.push({serviceName:e+"._googlecast._tcp.local",serviceHostPort:e+":"+f,ipAddress:a,serviceData:["id=mdns:"+e,"ve=02","ca=5","st=1","fn="+e,"md=Chromecast"]})});return b};qk.prototype.init=function(){var a=rk(Rf.O().pu);this.V.hH(a)};var sk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var tk=function(a,b){this.Je=[];this.sd=[];this.sinkId=a;this.session=b;this.zq=this.zm=null;this.offTheRecord=this.sq=!1};d=tk.prototype;d.Qs=function(a){if(sb(this.Je,a))return!1;this.Je.push(a);return!0};d.ox=function(a){return xb(this.Je,a)};d.ce=function(a){if(sb(this.sd,a))return!1;this.sd.push(a);return!0};d.xk=function(a){return xb(this.sd,a)};d.pV=function(a,b){lj(a)?(this.zq=a,this.zm=b):lj(this.session)&&(this.zq=this.session,this.zm=this.sinkId,this.session=a,this.sinkId=b);return this};
var uk=function(){this.a=C("mr.cast.SessionRecords");this.kb=[]};d=uk.prototype;d.init=function(){qf(this)};d.Ts=function(a,b){F(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.Md(a.sessionId);if(c)return c.pV(a,b);a=new tk(b,a);this.kb.push(a);return a};d.r1=function(a){F(this.a,"Removing session "+a);this.kb=mb(this.kb,function(b){return b.session.sessionId!=a})};d.lC=function(a){return(a=this.Md(a))?a.Je:[]};d.Tp=function(a){return(a=this.bm(a))?a.session:null};
d.dd=function(a){return qb(this.kb,function(b){return sb(b.Je,a)})};d.cg=function(a){return qb(this.kb,function(b){return sb(b.sd,a)})};d.aU=function(a){return qb(this.kb,function(b){return null!=qb(b.sd,function(b){return jk(b).PG==a})})};d.bm=function(a){return qb(this.kb,function(b){return b.sinkId==a||b.zm==a})};d.Md=function(a){return qb(this.kb,function(b){return b.session.sessionId==a})};d.BD=function(a){return(a=this.Md(a))?a.sinkId:null};d.cv=function(a){return(a=this.Md(a))?a.session:null};
d.x5=function(a,b){var c=this.cv(a);c&&(a=mb(b,function(a){return a.playerState!=chrome.cast.media.ho.IDLE},this),a.forEach(function(a){if(!a.media){var b=qb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.r0=function(a){for(var b=0;b<this.kb.length;b++)this.kb[b].ox(a)};var vk=function(a){this.kr=a};uk.prototype.Ra=function(){return"cast.SessionRecords"};uk.prototype.getData=function(){return[new vk(this.kb)]};
uk.prototype.vb=function(){var a=nf(this);if(a)for(var b=0;b<a.kr.length;b++){var c=a.kr[b],e=new tk(c.sinkId,c.session);e.Je=c.Je;e.sd=c.sd;e.sq=c.sq;e.zq=c.zq;e.zm=c.zm;this.kb.push(e)}};var wk=function(a){this.Uc="sender-"+bb();this.$a=new A;this.Ih=null;qf(this);this.C=a;this.Cb=new ok;this.ja=new uk;this.vc=new bk(this.Uc,this);this.V=new Ni(this.vc,this);this.aP=new qk(this.V);this.$c=new $i(this.vc,this.Uc);this.Ic=new ek(this.$c,this.V);this.Yc=new Qj(this.$c,this.V,this.Cb,this.ja,this.vc,this);this.kA=new gj(this.V,this.$c);this.x6=this.V.start.bind(this.V)};d=wk.prototype;d.a=C("mr.CastProvider");d.getName=function(){return"cast"};
d.jd=function(){this.$c.init();this.ja.init();this.Yc.init();this.vc.init();this.V.init();this.aP.init();this.Ic.init();this.C.ix(this.x6)};d.Ye=function(){return this.$a.A()};d.Ol=function(a){var b=new Sc;this.Bp(a).forEach(function(a){this.V.HU(a).map(function(a){return a.$f()}).forEach(function(a){b.add(a)})}.bind(this));return new gk(b.A(),-1!=a.indexOf("0F5096E8")?rh:null)};d.Bi=function(a){this.Bp(a).forEach(function(a){this.Ic.hx(a)}.bind(this));this.C.Ev()&&this.V.start()};d.Di=function(a){this.Bp(a).forEach(function(a){this.Ic.By(a)}.bind(this))};
d.Ai=function(){};d.Ci=function(){};d.W=function(a){return(a=this.V.W(a))?a.$f():null};d.r2=function(a){var b=new ah(sk,"warning","dismiss");b.routeId=a;this.C.Ve().send(b)};d.ZD=function(a,b){D(this.a,"Error launching.",b);this.r2(a.id);this.C.onPresentationConnectionClosed(a.id,"error","Launch error");this.xk(a.id,!1)};
d.ep=function(a,b,c,e,f,g,k){Rf.O().fi=new Qf(b.cc,b.la);var p=mk(a,b,c,!0);p.forDisplay=!1;p.offTheRecord=e;this.$a.set(p.id,p);this.C.lk(this,p);(e=Oj(a))&&e.Xb()&&this.qz(e,p.id,g,k);qh(a)?(p.pe={tabId:k,sessionId:"",AJ:b.la||"",BJ:b.cc||""},this.C.Jn(this,p,function(e){return this.bF(a,b,c,f,g,k,e)}.bind(this)).then(function(){this.UI(p)},function(a){this.ZD(p,a)},this)):this.bF(a,b,c,f,g,k,p).na(function(a){this.ZD(p,a)},this);return H(p)};
d.bF=function(a,b,c,e,f,g,k){return this.Yc.dw(this.Tw(a,b,e),b).then(function(e){this.ce(a,b,c,e,f,g,k);return k},null,this)};d.fe=function(a,b,c,e,f,g,k){var p=this.V.W(b);if(!p)return I(Error("No sink with ID "+b));var w=Mj(a);if(w){setTimeout(function(){this.Yc.ZH(w,p,chrome.cast.il.CAST)}.bind(this),0);var B=this.Cb.dd(w);if(B)return this.tc(B.routeId).then(function(){return this.ep(a,p,c,e,f,g,k)},null,this);if(g&&k&&(b=this.SA(a,g,k,e,f,b)))return b}return this.ep(a,p,c,e,f,g,k)};
d.pP=function(a,b){this.C.Qd(this,a,b)};d.oP=function(a,b){var c=this.$a.get(a);c&&c.ej&&this.C.Rq(this,a,b)};d.xk=function(a,b){F(this.a,"Remove route "+a);var c=this.Cb.cg(a);if(c){var e=c.clientId;F(this.a,"Remove client "+e);this.ja.r0(e);this.Cb.ox(e)}if(e=this.ja.cg(a))e.xk(a),this.sF(e.sd);var f=this.$a.get(a);f&&(f.ej&&e&&(this.vc.DA(f.sinkId,c?c.clientId:this.Uc,e.session.transportId,b),f.forDisplay&&c&&(this.Ih={Xi:c,dI:e})),this.$a.remove(a),this.C.Wh(this,f))};
d.F7=function(a){a.sd.forEach(function(b){if(b=this.$a.get(b)){var c=a.session;b.pe&&b.forDisplay?this.UI(b):(b.description=c.statusText||c.displayName,this.C.Xh(this,b))}}.bind(this))};d.y7=function(a){nb(a,function(a){a=this.$a.get(a,null);if(!a||!a.mediaSource)return!1;var c=Oj(a.mediaSource),c=c?c.xv:!1;return a.isLocal&&!c},this)&&v(a,function(a){if(a=this.$a.get(a,null))a.isLocal=!0},this)};
d.sF=function(a){var b=[],c=[],e=null;a.forEach(function(a){if(a=this.$a.get(a)){a.forDisplay=!1;var g=Oj(a.mediaSource);g&&qb(g.Nl(),sj)||(a.ej?(g=g?g.wu():null,e||g==chrome.cast.Ae.CUSTOM_CONTROLLER_SCOPED||(b.push(a),e=a.sinkId)):e&&e!=a.sinkId?b.push(a):c.push(a))}}.bind(this));v(0<b.length?b:c,function(a){a.forDisplay=!0})};d.qz=function(a,b,c,e){var f=a.Xb();f&&!this.Cb.dd(f)&&(F(this.a,"Add client "+f),this.Cb.Qs(b,f,a.Nl(),a.wu(),c||null,l(e)?e:null))};
d.UI=function(a){var b=this.ja.cg(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.ce=function(a,b,c,e,f,g,k){var p=null!=a,w;null==a?(w=new Ij([{appId:e.appId,capabilities:e.capabilities}]),a=w.toString()):w=Oj(a);a=k||mk(a,b,c||e.sessionId,p);p=a.id;F(this.a,"Add route "+p);c=null;w&&(c=w.Xb(),this.qz(w,p,f,g));(f=this.ja.bm(b.getId()))||(f=this.ja.Ts(e,b.getId()));f.ce(p);a.ej&&this.vc.XZ(b,c||this.Uc,e.transportId,!(w&&w.xv));f.offTheRecord=a.offTheRecord;this.$a.set(p,a);w=f.sd;this.y7(w);this.sF(w);w=e.sessionId;g=e.appId;("0F5096E8"==g||"85CDB22F"==g)&&w&&a.pe&&(a.pe.sessionId=
w);!qj(e,vi)||null!==e&&sb(rj,e.appId)||(a.customControllerPath="cast_route_details.html?"+["sessionId="+w,"appId="+g].join("&"));a.description=e.statusText||e.displayName;k?this.C.Xh(this,a):this.C.lk(this,a);c&&f.Qs(c)&&this.Yc.eZ(e,b,c);return a};
d.tc=function(a){var b=this.$a.get(a);if(!b)return H();var c=this.ja.cg(a);if(!c)return F(this.a,"Session for route "+a+" does not exist."),this.xk(a,!0),H();var e=this.V.W(b.sinkId);if(!e)return F(this.a,"Sink for route "+a+" is no longer reachable."),this.Yc.en(c.sinkId,"close-route"),H();(a=this.Cb.cg(a))&&this.Yc.ZH(a.clientId,e,chrome.cast.il.STOP);Di(0);var f=J();this.$c.E1(c.session.sessionId,e).Ab(function(){this.Yc.en(e.getId(),"close-route");f.resolve()},this);return f.promise};
d.pQ=function(a){var b=null;Hc(this.$a.jv(),function(c){if(!c.ej)return!1;var e=this.V.W(c.sinkId);if(!e||!a.$W(this.Tw(c.mediaSource,e)))return!1;b=c;return!0},this);if(!b||!b.mediaSource)return null;var c=Pj(b.mediaSource);if(!c)return null;var e=this.Cb.dd(c);return e?(c=this.ja.dd(c))?{Xi:e,dI:c}:null:null};
d.SM=function(a,b,c){var e=this.pQ(a);if(!e){if(!this.Ih||this.Ih.Xi.origin!=b||this.Ih.Xi.tabId!=c)return null;e=this.Ih}switch(a.wu()){case chrome.cast.Ae.PAGE_SCOPED:return null;case chrome.cast.Ae.ORIGIN_SCOPED:if(b!=e.Xi.origin)return null;break;case chrome.cast.Ae.TAB_AND_ORIGIN_SCOPED:if(b!=e.Xi.origin||c!=e.Xi.tabId)return null}return this.ja.Md(e.dI.session.sessionId)};
d.SA=function(a,b,c,e,f,g){var k=null;Hc(this.$a.jv(),function(a){var b=a.pe;return b&&null!=b.tabId&&b.tabId==c&&ph(a.mediaSource)?(k=a,!0):!1});return k?this.tc(k.id).then(function(){return this.fe(a,g||k.sinkId,"",e,f,b,null==c?void 0:c)},null,this):null};
d.$g=function(a,b,c,e,f){if(!Oj(a))return I(Error("Unsupported presentation URL"));b=jk(b);b=this.ja.Md(b.PG);if(!b)return I(Error("No matching route"));var g=this.V.W(b.sinkId);if(!g)return I(Error("No sink"));a=this.ce(a,g,c,b.session,e,f);return H(a)};
d.Hh=function(a,b,c,e,f,g){var k=Oj(a);if(!k)return I(Error("Unsupported presentation URL"));var p;if(b==chrome.cast.UK){if(p=this.SM(k,f,g),!p&&k.vR()!=chrome.cast.fo.CAST_THIS_TAB&&(e=this.SA(a,f,g,c,e)))return e}else p=0==b.indexOf(chrome.cast.dz)?this.ja.Md(b.substr(chrome.cast.dz.length)):this.ja.aU(b);if(!p)return I(Error("No matching route"));if(p.offTheRecord!=c)return I(Error("Off the record mismatch"));e=this.V.W(p.sinkId);if(!e)return I(Error("No sink"));a=this.ce(a,e,b,p.session,f,g);
a.offTheRecord=c;return H(a)};d.Pf=function(a){this.xk(a,!1)};d.Zf=function(a){var b=!0,c=!0;if(a=this.V.W(a))b=a.Zc,c=!!(b&1),b=!!(b&4);return bi(b,c)};d.Xl=function(){return"cast_streaming"};
d.Cg=function(a,b,c){if(!c)return this.Yc.Qd(a,b),H();var e=this.ja.cg(a);if(!e)return I(Error("Not managing the route "+a));var f=this.V.W(e.sinkId);if(!f)return I(Error("Sink no longer accessible"));a=(a=this.Cb.cg(a))?a.clientId:this.Uc;var g=J();this.vc.ur(f,c.namespace,b,a,e.session.transportId).Ab(function(){g.resolve()});return g.promise};d.ql=function(a,b){var c=this.V.W(b);if(!c)return!1;a=this.Tw(a,c);return(a=Nj(a))&&0!=a.length?nb(a,function(a){return Gi(c.Id(a))}):!1};
d.Ti=function(a,b){var c=this.Bp(a);return c&&0!=c.length?b&&b.mediaSource?(a=Nj(b.mediaSource),nb(a,function(a){return sb(c,a)},this)):!0:!1};d.xU=function(a){return(a=this.$a.get(a))?Mj(a.mediaSource):null};d.Tw=function(a,b,c){return qh(a)?(a={appId:0==(b.Zc&1)?"85CDB22F":"0F5096E8",capabilities:nj(b.Zc)},(new Ij([a],void 0,void 0,void 0,c)).toString()):a};d.Bp=function(a){var b=[];qh(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=Nj(a))&&(b=Bb(b,a));return b};
d.uw=function(a){this.V.uw(a.getId());Di(2)};d.zY=function(a){this.Yc.$G(a,!0)};d.xY=function(a,b){this.kA.wV(a,b);this.Yc.AZ(a.getId(),b)};d.Yh=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Qc(a);this.Yc.$G(a)};d.Tq=function(a){if(0==this.V.kc().length)this.C.onSinkAvailabilityUpdated(this,0);this.Yc.Tq(a.getId());this.aE()};d.Qc=function(a){this.Ic.rn(a);this.aE()};d.aE=function(){this.kA.ZV();this.C.pc()};var xk=function(a,b,c){this.bI=a;this.routes=b;this.jX=c};wk.prototype.Ra=function(){return"cast.Provider"};
wk.prototype.getData=function(){return[new xk(this.Uc,this.$a.b(),this.Ih)]};wk.prototype.vb=function(){var a=nf(this);a&&(this.Uc=a.bI,this.$a.addAll(a.routes),this.Ih=a.jX)};wk.prototype.rf=function(){return null};var yk=function(){if(!Wc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},zk=Wc&&yk();var Ak=function(){this.Hd=[];this.de=[]};d=Ak.prototype;d.HX=function(){0==this.Hd.length&&(this.Hd=this.de,this.Hd.reverse(),this.de=[])};d.enqueue=function(a){this.de.push(a)};d.Of=function(){this.HX();return this.Hd.pop()};d.N=function(){return this.Hd.length+this.de.length};d.Db=function(){return 0==this.Hd.length&&0==this.de.length};d.clear=function(){this.Hd=[];this.de=[]};d.contains=function(a){return sb(this.Hd,a)||sb(this.de,a)};
d.remove=function(a){var b;b=this.Hd;var c=kb(b,a);0<=c?(wb(b,c),b=!0):b=!1;return b||xb(this.de,a)};d.A=function(){for(var a=[],b=this.Hd.length-1;0<=b;--b)a.push(this.Hd[b]);for(var c=this.de.length,b=0;b<c;++b)a.push(this.de[b]);return a};var Bk=function(a,b){ve.call(this);this.JF=a||0;this.Nh=b||10;if(this.JF>this.Nh)throw Error("[goog.structs.Pool] Min can not be greater than max");this.Pb=new Ak;this.fg=new Sc;this.Ut=0;this.Pv=null;this.oo()};u(Bk,ve);d=Bk.prototype;d.getObject=function(){var a=t();if(!(null!=this.Pv&&a-this.Pv<this.Ut)){var b=this.h1();b&&(this.Pv=a,this.fg.add(b));return b}};d.gi=function(a){return this.fg.remove(a)?(this.Rs(a),!0):!1};
d.h1=function(){for(var a;0<this.FC()&&(a=this.Pb.Of(),!this.sw(a));)this.oo();!a&&this.N()<this.Nh&&(a=this.Ne());return a};d.Rs=function(a){this.fg.remove(a);this.sw(a)&&this.N()<this.Nh?this.Pb.enqueue(a):this.ih(a)};d.oo=function(){for(var a=this.Pb;this.N()<this.JF;)a.enqueue(this.Ne());for(;this.N()>this.Nh&&0<this.FC();)this.ih(a.Of())};d.Ne=function(){return{}};d.ih=function(a){if("function"==typeof a.ib)a.ib();else for(var b in a)a[b]=null};
d.sw=function(a){return"function"==typeof a.KN?a.KN():!0};d.contains=function(a){return this.Pb.contains(a)||this.fg.contains(a)};d.N=function(){return this.Pb.N()+this.fg.N()};d.zS=function(){return this.fg.N()};d.FC=function(){return this.Pb.N()};d.Db=function(){return this.Pb.Db()&&this.fg.Db()};d.K=function(){Bk.R.K.call(this);if(0<this.zS())throw Error("[goog.structs.Pool] Objects not released");delete this.fg;for(var a=this.Pb;!a.Db();)this.ih(a.Of());delete this.Pb};var Ck=function(a,b){this.af=a;this.Fi=b};Ck.prototype.getKey=function(){return this.af};Ck.prototype.$b=function(){return this.Fi};Ck.prototype.clone=function(){return new Ck(this.af,this.Fi)};var Dk=function(a){this.od=[];a&&this.yW(a)};d=Dk.prototype;d.insert=function(a,b){var c=this.od;c.push(new Ck(a,b));this.eY(c.length-1)};d.yW=function(a){var b;if(a instanceof Dk){if(b=a.ab(),a=a.A(),0>=this.N()){for(var c=this.od,e=0;e<b.length;e++)c.push(new Ck(b[e],a[e]));return}}else b=Rb(a),a=Qb(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.od,b=a.length,c=a[0];if(!(0>=b))return 1==b?tb(a):(a[0]=a.pop(),this.dY(0)),c.$b()};
d.dY=function(a){for(var b=this.od,c=b.length,e=b[a];a<c>>1;){var f=this.HS(a),g=this.vU(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.eY=function(a){for(var b=this.od,c=b[a];0<a;){var e=this.IT(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.HS=function(a){return 2*a+1};d.vU=function(a){return 2*a+2};d.IT=function(a){return a-1>>1};d.A=function(){for(var a=this.od,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].$b());return b};
d.ab=function(){for(var a=this.od,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.bj=function(a){return nb(this.od,function(b){return b.$b()==a})};d.Oa=function(a){return nb(this.od,function(b){return b.getKey()==a})};d.clone=function(){return new Dk(this)};d.N=function(){return this.od.length};d.Db=function(){return 0==this.od.length};d.clear=function(){tb(this.od)};var Ek=function(){Dk.call(this)};u(Ek,Dk);Ek.prototype.enqueue=function(a,b){this.insert(a,b)};Ek.prototype.Of=function(){return this.remove()};var Fk=function(a,b){this.aB=void 0;this.or=new Ek;Bk.call(this,a,b)};u(Fk,Bk);d=Fk.prototype;d.getObject=function(a,b){if(!a)return(a=Fk.R.getObject.call(this))&&this.Ut&&(this.aB=h.setTimeout(r(this.bq,this),this.Ut)),a;this.or.enqueue(l(b)?b:100,a);this.bq()};d.bq=function(){for(var a=this.or;0<a.N();){var b=this.getObject();if(b)a.Of().apply(this,[b]);else break}};d.Rs=function(a){Fk.R.Rs.call(this,a);this.bq()};d.oo=function(){Fk.R.oo.call(this);this.bq()};
d.K=function(){Fk.R.K.call(this);h.clearTimeout(this.aB);this.or.clear();this.or=null};var Gk=function(a,b,c,e){this.Eh=a;this.Ki=!!e;Fk.call(this,b,c)};u(Gk,Fk);Gk.prototype.Ne=function(){var a=new $f,b=this.Eh;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Ki&&a.hy(!0);return a};Gk.prototype.sw=function(a){return!a.isDisposed()&&!a.$e()};var Hk=function(a,b,c,e,f,g){M.call(this);this.cf=l(a)?a:1;this.yf=l(f)?Math.max(0,f):0;this.fl=new Gk(b,c,e,g);this.gc=new A;this.Ia=new ei(this)};u(Hk,M);var Ik="ready complete success error abort timeout".split(" ");d=Hk.prototype;d.Nr=function(a){this.yf=Math.max(0,a)};d.send=function(a,b,c,e,f,g,k,p,w,B){if(this.gc.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Jk(b,r(this.CV,this,a),c,e,f,k,l(p)?p:this.cf,w,B);this.gc.set(a,b);a=r(this.sV,this,a);this.fl.getObject(a,g);return b};
d.abort=function(a,b){var c=this.gc.get(a);if(c){var e=c.Bs;c.K2(!0);b&&(e&&(this.sH(e,c.Qy),Xe(e,"ready",function(){this.fl.gi(e)},!1,this)),this.gc.remove(a));e&&e.abort()}};d.sV=function(a,b){var c=this.gc.get(a);c&&!c.Bs?(this.JM(b,c.Qy),b.Nr(this.yf),b.gJ(c.yk),b.hy(c.Ki),c.Bs=b,this.dispatchEvent(new Kk("ready",this,a,b)),this.EH(a,b),c.mz&&b.abort()):this.fl.gi(b)};
d.CV=function(a,b){var c=b.target;switch(b.type){case "ready":this.EH(a,c);break;case "complete":return this.zV(a,c,b);case "success":this.bW(a,c);break;case "timeout":case "error":this.km(a,c);break;case "abort":this.qV(a,c)}return null};d.EH=function(a,b){var c=this.gc.get(a);!c||c.JA||c.sv()?(c&&(this.sH(b,c.Qy),this.gc.remove(a)),this.fl.gi(b)):(c.oW(),b.send(c.getUrl(),c.YX,c.cj,c.Jp()))};
d.zV=function(a,b,c){var e=this.gc.get(a);if(7==b.jg||b.kd()||e.sv())if(this.dispatchEvent(new Kk("complete",this,a,b)),e&&(e.j3(!0),e.IA))return e.IA.call(b,c);return null};d.qV=function(a,b){this.dispatchEvent(new Kk("abort",this,a,b))};d.bW=function(a,b){this.dispatchEvent(new Kk("success",this,a,b))};d.km=function(a,b){this.gc.get(a).sv()&&this.dispatchEvent(new Kk("error",this,a,b))};d.sH=function(a,b,c){this.Ia.Xc(a,c||Ik,b)};d.JM=function(a,b,c){this.Ia.listen(a,c||Ik,b)};
d.K=function(){Hk.R.K.call(this);this.fl.ib();this.fl=null;this.Ia.ib();this.Ia=null;this.gc.clear();this.gc=null};var Kk=function(a,b,c,e){K.call(this,a,b);this.id=c;this.Bs=e};u(Kk,K);var Jk=function(a,b,c,e,f,g,k,p,w){this.qs=a;this.YX=c||"GET";this.cj=e;this.Eh=f||null;this.cf=l(k)?k:1;this.Qz=0;this.mz=this.JA=!1;this.Qy=b;this.IA=g;this.yk=p||"";this.Ki=!!w;this.Bs=null};d=Jk.prototype;d.getUrl=function(){return this.qs};d.Jp=function(){return this.Eh};d.Np=function(){return this.cf};d.oW=function(){this.Qz++};
d.sv=function(){return this.Qz>this.cf};d.j3=function(a){this.JA=a};d.K2=function(a){this.mz=a};var Lk=function(){this.name="unknown";this.state="error";this.DW=null;this.allowStop=!0;this.serviceData=this.ki=null;this.extraData={}},Ok=function(a,b,c){this.Wd=a;(a=b)||(Mk||(Mk=new Hk(3,null,1,10,2E3)),a=Mk);this.eo=a;this.gl=[];c||(Nk||(Nk=new Hk(0,null,1,10,15E3)),c=Nk);this.TK=c;this.a=C("mr.dial.Client")};Ok.prototype.abort=function(){this.gl.forEach(function(a){this.eo.abort(a,!0);this.TK.abort(a,!0)},this)};var Mk=null,Nk=null,Pk=999;
Ok.prototype.launchApp=function(a,b){var c=J(),e=(++Pk).toString();this.gl.push(e);this.TK.send(e,this.vu(a),"POST",b,null,0,this.KB("launchApp","POST",e,c));return c.promise};Ok.prototype.MJ=function(a){var b=J(),c=(++Pk).toString();this.gl.push(c);this.eo.send(c,this.vu(a),"DELETE",null,null,0,this.KB("stopApp","DELETE",c,b),0);return b.promise};var Qk=function(a,b){this.SK=a;this.De=b;this.h2=!!b&&"running"==b.state};
Ok.prototype.uu=function(a){return new ie(function(b){var c=(++Pk).toString();this.gl.push(c);this.eo.send(c,this.vu(a),"GET",null,null,0,r(this.LY,this,c,b))},this)};
Ok.prototype.LY=function(a,b,c){xb(this.gl,a);a=c.target;Tf(this.a,"GetAppInfo","GET",a,!0);if(a.kd()){c=a.sD();if(!c)if(c=a.Gj(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(zk){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(p){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new Lk;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.ki=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)F(this.a,
"GET response missing name value"),b(new Qk(a,null));else if("error"==c.state)F(this.a,"GET response missing state value"),b(new Qk(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.DW=e[1];else if("running"!=c.state&&"stopped"!=c.state){F(this.a,"GET response has invalid state value");b(new Qk(a,null));return}b(new Qk(a,c))}}else F(this.a,"Invalid GET response (invalid service)"),b(new Qk(a,null));else F(this.a,"Empty response"),b(new Qk(a,null))}else F(this.a,"Request to "+
a.Lp()+" failed"),b(new Qk(a,null))};Ok.prototype.vu=function(a){var b=this.Wd.Qf;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};Ok.prototype.KB=function(a,b,c,e){return r(function(f){xb(this.gl,c);f=f.target;Tf(this.a,a,b,f,!0);f.kd()?e.resolve():e.reject(Error(Uf(f.jg)))},this)};var Rk=function(a,b,c){this.appName=b;this.launchParameter=c||""},Sk=C("mr.DialProvider"),Uk=function(a){if(Ma(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new Rk(a,c,0<b?a.substring(b+1):void 0):null}else a=Tk(a);return a},Vk=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Wk=/__dialPostData__=([A-Za-z0-9]+={0,2})/,Tk=function(a){var b=(new xj(a)).Sf;if(!b)return null;var c=Vk.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);
if(b=(b=Wk.exec(b))?b[1]:void 0)try{b=Nf(b)}catch(e){return E(Sk,"Invalid base64 encoded postData:"+b),null}return new Rk(a,c,b)};var Xk=function(a,b){this.Ea=a;this.appName=b};var Yk=function(a){this.Sc=new la;this.Os=a};d=Yk.prototype;d.init=function(){qf(this)};d.clear=function(){this.Sc.clear()};d.add=function(a){this.eC(a.Ea.id)||(this.Sc.set(a.Ea.id,a),this.Os.jY(a))};d.eC=function(a){return this.Sc.get(a)||null};d.fC=function(a){for(var b=fa(this.Sc),c=b.next();!c.done;c=b.next())if(c=fa(c.value),c.next(),c=c.next().value,c.Ea.sinkId==a)return c;return null};d.d1=function(a){if(a=this.fC(a))this.Sc.delete(a.Ea.id),this.Os.TF(a)};
d.oH=function(a){var b=this.Sc.get(a);b&&(this.Sc.delete(a),this.Os.TF(b))};d.Ye=function(){return ja(this.Sc.values(),function(a){return a.Ea})};d.CQ=function(){return ja(this.Sc.values())};d.Ra=function(){return"dial.ActivityRecords"};d.getData=function(){return[ja(this.Sc)]};d.vb=function(){var a=nf(this);a&&(this.Sc=new la(a))};var Zk={v9:0,Eaa:1,O$:2,u9:3},$k={ERROR:0,faa:1,EMPTY:2},al=function(a){kh("MediaRouter.Dial.Create.Route",a,Zk)},bl=function(a){kh("MediaRouter.Dial.Device.Description.Failure",a,$k)};var cl=function(a,b){this.a=C("mr.dial.AppDiscoveryService");this.fc=new na;this.V=a;this.Gc=b;this.Jb=new la;this.Ft=new la;this.Yd=null;this.Ck=!1};d=cl.prototype;d.init=function(){qf(this)};d.start=function(){F(this.a,"Starting periodic scanning.");this.Ck||(this.Ck=!0,this.jB())};d.stop=function(){F(this.a,"Stopping periodic scanning.");this.Ck&&(this.Ck=!1,this.Yd&&(clearTimeout(this.Yd),this.Yd=null),this.Jb.clear(),this.Ft.forEach(function(a){a.abort()}))};
d.hx=function(a){if(!this.fc.has(a)||this.LM(a))this.fc.add(a),0!=this.V.Up()&&(this.Ck?this.V.kc().forEach(this.iB.bind(this,a)):this.start())};d.By=function(a){this.fc.delete(a)};d.eU=function(){return ja(this.fc)};
d.jB=function(){F(this.a,"Start app status scan.");var a=[];this.V.kc().forEach(function(b){a.push.apply(a,this.rn(b))},this);this.Gc.CQ().forEach(function(b){a.push(this.j2(b))},this);pe(a).Ab(function(){this.Ck&&!this.Yd&&(G(this.a,"Scan complete; scheduling for next scan."),this.Yd=setTimeout(this.xP.bind(this),6E4))},this)};d.xP=function(){G(this.a,"Start app status scan (timer-based)");this.Yd=null;this.jB()};
d.rn=function(a){if(!a.Xk)return[];for(var b=[],c=fa(this.fc),e=c.next();!e.done;e=c.next())b.push(this.iB(e.value,a));return b};d.iB=function(a,b){if("unknown"!=b.Id(a)&&36E5>t()-b.EQ(a)||!b.Xk)return H();G(this.a,"Querying "+b.getId()+" for "+a+" to update app status");return this.ZB(b,a).then(this.LX.bind(this,b,a))};
d.j2=function(a){var b=this.V.W(a.Ea.sinkId);if(!b)return E(this.a,"Activity refers to nonexistent sink: "+a.Ea.id),H();if(!b.Xk)return H();a=a.appName;G(this.a,"Querying "+b.getId()+" for "+a+" to update activity");return this.ZB(b,a).then(this.KX.bind(this,b,a))};d.KR=function(a){var b=this.Ft.get(a.getId());b||(b=new Ok(a),G(this.a,"Created DIAL client for "+a.getId()),this.Ft.set(a.getId(),b));return b};
d.ZB=function(a,b){var c=dl(a,b),e=this.Jb.get(c);if(e)return e;e=this.KR(a).uu(b);this.Jb.set(c,e);e.Ab(function(){this.Jb.delete(c)},this);return e};d.MQ=function(a,b){if(404==b.SK.Qa())return"unavailable";b=b.De;if("Netflix"==a)return this.wP(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.wP=function(a){return a.extraData&&l(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var dl=function(a,b){return a.getId()+":"+b};d=cl.prototype;d.LX=function(a,b,c){if(404==c.SK.Qa()||c.De){c=this.MQ(b,c);G(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);var e=a.Id(b);a.yn(b,c);c!=e&&this.V.sY(b,a)}else E(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.qJ(!1)};
d.KX=function(a,b,c){(a=this.Gc.fC(a.getId()))&&a.appName==b&&!c.h2&&this.Gc.oH(a.Ea.id)};d.LM=function(a){return this.V.kc().some(function(b){return"unknown"==b.Id(a)})};d.Ra=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.eU()]};d.vb=function(){var a=nf(this);this.fc=new na(a||[])};var el=function(){this.configId=this.modelName=this.deviceType=this.ju=this.lu=this.vo=this.ipAddress=this.friendlyName=this.deviceLabel=this.Vn=null};el.prototype.U7=function(){return this.deviceLabel?this.Vn?this.friendlyName?this.ipAddress?this.vo?this.lu?this.ju?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
el.prototype.toString=function(){return JSON.stringify(this,function(a,b){return n(b)&&0==b.indexOf("uuid:")?"***":b})};var hl=function(a){this.rt=new A;this.Jb=new Sc;this.Nw=new A;var b;(b=a)||(fl||(fl=new Hk(3,null,1,10,2E3)),b=fl);this.eo=b;a||(gl||(gl=new Hk(2,null,1,10,3E3)),a=gl);this.nM=a;this.a=C("mr.dial.DeviceDescriptionService")},fl=null,gl=null;d=hl.prototype;
d.HR=function(a){var b=this.ZN(a);return b?(jh("MediaRouter.Dial.Device.Description.Cached"),H(b)):this.Jb.contains(a.deviceLabel)?I(Error("Duplicate request for device "+a.deviceLabel)):this.fQ(a)};d.ZN=function(a){var b=this.rt.get(a.deviceLabel);return b?b.configId!=a.configId||t()>=b.ju?(G(this.a,"Removing invalid entry "+b.toString()),this.rt.remove(a.deviceLabel),null):b:null};
d.fQ=function(a){var b=J();this.Jb.add(a.deviceLabel);this.eo.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,r(function(c){(c=this.i0(a,c))?b.resolve(c):b.reject(Error("Failed to get device description"))},this));return b.promise};
d.i0=function(a,b){this.Jb.remove(a.deviceLabel);b=b.target;Tf(this.a,"fetchDeviceDescription","GET",b);if(!b.kd())return F(this.a,"Request to "+b.Lp()+" failed"),bl(0),null;var c=b.sD();if(!c)return F(this.a,"Invalid or empty response"),bl(2),null;b=this.q_(b,a,c);if(!b)return bl(1),F(this.a,"Invalid device description"),null;F(this.a,"Got device description for "+b.deviceLabel);G(this.a,"... device description was: "+b.toString());null!=b.configId&&(G(this.a,"Caching device description for "+b.deviceLabel),
this.rt.set(a.deviceLabel,b));return b};
d.q_=function(a,b,c){var e=new el;e.lu=t();e.ju=e.lu+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.vo=a.getResponseHeader("Application-URL")||null;a=e.vo;a=a instanceof xj?a.clone():new xj(a,void 0);e.ipAddress=a.Wf();e.deviceType=il(c,"deviceType");e.modelName=il(c,"modelName");e.friendlyName=il(c,"friendlyName");if(a=e.friendlyName)200<a.length&&(a=a.substring(0,197)+"..."),Xa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ra,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Sa,"&lt;")),-1!=a.indexOf(">")&&
(a=a.replace(Ta,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ua,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Va,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Wa,"&#0;")));e.friendlyName=a;e.Vn=il(c,"UDN");a=e.U7();G(this.a,"Device description: "+jl(c));return a?(E(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var il=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},jl=function(a){var b=function(a){for(var b=0,f=a.length;b<f;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
hl.prototype.sl=function(a){var b=this.Nw.get(a);if(b)return b.promise;b=J();this.Nw.set(a,b);this.nM.send(a,a,"GET",null,null,0,r(function(c){this.Nw.remove(a);c=c.target;Tf(this.a,"checkAccess","GET",c,!1);b.resolve(c.kd())},this));return b.promise};var kl=function(a,b){this.Hn=a;this.dB=b||new hl;this.a=C("mr.dial.SinkDiscoveryService");this.Vd=new A;this.gh=r(this.HY,this);this.tB=r(this.JZ,this);this.Nq=this.Wj=!1},ll={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"};d=kl.prototype;d.init=function(){qf(this)};
d.start=function(){this.Wj||(F(this.a,"Starting..."),chrome.dial?(chrome.dial.onDeviceList.addListener(this.gh),chrome.dial.onError.addListener(this.tB),this.Wj=!0,this.refresh()):(E(this.a,"Dial API not available, aborting start..."),this.Wj=!1))};d.stop=function(){this.Wj?(this.Wj=!1,chrome.dial.onDeviceList.removeListener(this.gh),chrome.dial.onError.removeListener(this.tB)):F(this.a,"Was not started.")};
d.refresh=function(){this.Wj?chrome.dial.discoverNow(r(function(a){F(this.a,"chrome.dial.discoverNow = "+a)},this)):F(this.a,"Not started. Ignoring discover().")};d.HY=function(a){F(this.a,"onDeviceList returned "+a.length+" devices");G(this.a,"....the list is: "+JSON.stringify(a));this.Nq=!1;var b=[],c=new Sc;a.forEach(function(a){b.push(this.j0(a).then(function(a){c.add(a.getId());this.FX(a)},ya,this))},this);oe(b).Ab(function(){this.Nq||this.er(c)},this)};
d.FX=function(a){if(!this.Nq){G(this.a,"mayAddSink, id = "+a.getId());var b=this.Vd.get(a.getId());b?b.update(a)&&(G(this.a,"Updated sink "+b.getId()),this.Hn.Qc(b)):(G(this.a,"Adding new sink "+a.getId()),Sd(this.a,Kd,"...sink was "+a.WJ()),this.Vd.set(a.getId(),a),this.Hn.Yh(a))}};d.er=function(a){this.Vd.A().forEach(function(b){a.contains(b.getId())||this.YN(b).then(function(a){a||(this.Hn.ff([b]),this.Vd.remove(b.getId()))},null,this)},this)};d.YN=function(a){return a.Qe?this.dB.sl(a.Qe):H(!1)};
d.j0=function(a){return this.dB.HR(a).then(function(b){var c;b.Vn?(c=b.Vn,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.Vn?Rf.O().wp(c):a.deviceLabel,f=ml.test(b.modelName);return(new Ii(b.friendlyName,c)).Dr(e).W3(b.ipAddress).u3(b.vo).t3(a.deviceDescriptionUrl).q4(b.modelName).qJ(!f)},null,this)};var ml=/Eureka Dongle|Chromecast Audio/i;d=kl.prototype;
d.JZ=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":E(this.a,"DIAL error: "+a.code+". Clear device list now.");this.Hn.ff(this.Vd.A());this.Vd.clear();this.Nq=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":E(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:E(this.a,"Unhandled DIAL error: "+a.code)}};d.W=function(a){return this.Vd.get(a,null)};
d.IU=function(a){var b=[];this.kc().forEach(function(c){"available"==c.Id(a)&&b.push(c.$f())});var c=ll[a];return new gk(b,c?[c]:void 0)};d.kc=function(){return this.Vd.A()};d.Up=function(){return this.Vd.N()};d.sY=function(a,b){this.Hn.Qc(b)};d.Ra=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.Vd.b()]};d.vb=function(){var a=nf(this);if(a)for(var b in a)this.Vd.set(b,Ji(a[b]))};var nl=function(a,b,c){this.C=a;this.rc=b||new kl(this);this.Gc=new Yk(this);this.Ic=c||new cl(this.rc,this.Gc);this.Y1=new Zi("dial.RouteIdGenerator")};d=nl.prototype;d.a=C("mr.DialProvider");d.getName=function(){return"dial"};d.jd=function(){this.Y1.qB();this.Gc.init();this.rc.init();this.Ic.init();this.Em()};d.Ol=function(a){G(this.a,"GetAvailableSinks for "+a);return(a=Uk(a))?this.rc.IU(a.appName):hk};d.Bi=function(a){if(a=Uk(a))this.Ic.hx(a.appName),this.Em()};
d.Di=function(a){if(a=Uk(a))this.Ic.By(a.appName),this.Jq()};d.Ai=function(){this.Em()};d.Ci=function(){this.Jq()};d.Jq=function(){(0==this.rc.Up()||0==this.Ic.fc.size&&0==this.Gc.Sc.size)&&this.Ic.stop()};d.Em=function(){this.rc.start();0<this.rc.Up()&&(0<this.Ic.fc.size||0<this.Gc.Sc.size)&&this.Ic.start()};d.W=function(a){return(a=this.rc.W(a))?a.$f():null};d.Ye=function(){return this.Gc.Ye()};
d.fe=function(a,b,c,e){var f=this.rc.W(b);if(!f)return al(0),I(Error("Unkown sink: "+b));Rf.O().fi=new Qf(f.cc,f.la);var g=Uk(a);if(!g)return I(Error("No app name set."));f.Fr(!0);var k=g.appName,p=new Ok(f);return p.uu(k).then(function(a){if(!a.De)throw Error("Failed to get app info");if("running"==a.De.state)return p.MJ(k)}).then(function(){return p.launchApp(k,g.launchParameter)}).then(function(){return this.ce(b,a,!0,k,c,e)},null,this).na(function(a){al(3);throw a;}).Ab(function(){f.Fr(!1)})};
d.Hh=function(){return I(Error("no supported"))};d.$g=function(){return I(Error("no supported"))};d.Pf=function(){};d.ce=function(a,b,c,e,f,g){al(1);a=lk(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.Gc.add(new Xk(a,e));return a};d.Yh=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Em();this.Ic.rn(a);this.C.pc();Rf.O().ei=new Qf(a.cc,a.la)};d.ff=function(a){if(0==this.rc.Up())this.C.onSinkAvailabilityUpdated(this,0);this.Jq();a.forEach(function(a){this.Gc.d1(a.getId())},this);this.C.pc()};
d.Qc=function(){this.C.pc()};d.jY=function(a){this.Em();this.C.lk(this,a.Ea)};d.TF=function(a){a=a.Ea;if(a.isLocal)this.C.onPresentationConnectionStateChanged(a.id,"terminated");this.Jq();this.C.Wh(this,a)};d.tc=function(a){var b=this.Gc.eC(a);if(!b)return H();this.Gc.oH(a);a=this.rc.W(b.Ea.sinkId);if(!a)return H();(new Ok(a)).MJ(b.appName);return H()};d.Zf=function(){return null};d.Xl=function(){return null};d.Cg=function(){return I(Error("DIAL sending message is not supported"))};
d.ql=function(a,b){b=this.rc.W(b);return!b||qh(a)?!1:(a=Uk(a))?"available"==b.Id(a.appName):!1};d.Ti=function(){return!1};d.rf=function(){return null};var ol=function(a,b){this.RN=a;this.Wt=b;this.Ff=this.RN.V;this.a=C("mr.cast.CastDialSinkDiscoveryCallbacks")};d=ol.prototype;d.zP=function(a){return this.Ff.sl(a)};d.zD=function(a){var b=this.Ff.W(a.getId());return b?b:(a=a.la)?this.Ff.GU(a,Rf.O().rl||8009):null};d.Yh=function(a){this.zD(a)?Ei(2):this.gK(a);this.Wt.Yh(a)};d.gK=function(a){var b=Mi(a);b&&this.zP(b).then(function(c){c?this.zD(a)?Ei(2):(this.Ff.mo(b),Ei(0)):jh("MediaRouter.Dial.Sink.Discovered.NonCast")},ya,this)};
d.ff=function(a){v(a,function(a){var c=this.Ff.W(a.getId());c&&c.Gl&&this.Ff.gn(a.getId())},this);this.Wt.ff(a)};d.Qc=function(a){var b=this.Ff.W(a.getId());b?b.Gl&&(b.update(a.Tl(),a.la,b.tb(),b.Zc)&&F(this.a,"Updated Cast sink with DIAL sink: "+a.getId()),this.Ff.Qc(b)):this.gK(a);this.Wt.Qc(a)};var pl=function(a,b){this.V=new kl(new ol(b,this));this.Ak=new A;this.C=a;this.Ix=this.un=0;this.cw=new Sc;this.Ka=new nl(this,this.V)},ql=/__dialAppName__/;d=pl.prototype;d.getName=function(){return this.Ka.getName()};d.jd=function(){this.Ka.jd()};d.Ye=function(){return this.Ka.Ye()};d.fG=function(){};d.Ol=function(a){return this.Ka.Ol(a)};d.Bi=function(a){this.Ka.Bi(a)};d.Di=function(a){this.Ka.Di(a)};d.Ai=function(a){this.Ka.Ai(a)};d.Ci=function(a){this.Ka.Ci(a)};d.W=function(a){return this.Ka.W(a)};
d.gR=function(a){return new Ok(a)};d.LR=function(a){return this.V.W(a)};
d.uP=function(a,b,c,e){var f=Uk(a),g=this.LR(b);if(!g)return I(Error("Attempting custom launch with closed route"));g.Fr(!0);var k=f.appName;if(!k)return I(Error("No app name given"));var p=null;return this.gR(g).uu(k).then(function(a){if(!a.De)return I(Error("Failed to get app info"));p=a.De},null,this).then(function(){return this.Ka.ce(b,a,!0,k,e||"",c)},null,this).then(function(b){var c={Ea:b,HE:!1,Tr:g,appName:k,De:p,launchParameter:f.launchParameter,session:null,clientId:null};this.Ak.set(b.id,
c);var e=Mj(a);if(!e)return I(Error("No client ID"));this.LO(c,e);return b},null,this).Ab(function(){g.Fr(!1)})};d.KW=function(a){return ql.test(a)};d.fe=function(a,b,c,e,f,g,k){return this.KW(a)?this.uP(a,b,e,c):this.Ka.fe(a,b,c,e,f,g,k)};
d.tc=function(a){var b=this.Ak.get(a);return b&&b.session&&b.clientId?(a={receiver:this.Mt(b.Tr),action:chrome.cast.il.STOP},a=new uj("receiver_action",a),a.clientId=b.clientId,this.C.Qd(this,b.Ea.id,a),a=new uj("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.C.Qd(this,b.Ea.id,a),b.HE=!0,H()):this.Ka.tc(a)};
d.Cg=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.x1(a,e.clientId);case "custom_dial_launch":if(this.cw.contains(e.sequenceNumber))return this.DY(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.tc(a),H()}return this.Ka.Cg(a,b,c)};d.BT=function(){var a=String(this.Ix);this.Ix=(this.Ix+1)%9007199254740992;return a};
d.LO=function(a,b){var c=this.Mt(a.Tr),e=new uj("receiver_action",{receiver:c,action:chrome.cast.il.CAST});e.clientId=b;this.C.Qd(this,a.Ea.id,e);c=new chrome.cast.T(this.BT(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new uj("new_session",c);c.clientId=b;this.C.Qd(this,a.Ea.id,c)};
d.DY=function(a,b){this.cw.remove(b.sequenceNumber);b=b.message;a=this.Ak.get(a);if(!a)return I(Error("Unknown route"));if(b&&!b.doLaunch)return H();var c=a.Tr;if(!c)return I(Error("Custom launch response for sink that no longer exists"));var c=new Ok(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};d.Mt=function(a){var b=new chrome.cast.Js(a.getId(),a.Tl());b.ipAddress=a.la;b.receiverType=chrome.cast.io.DIAL;return b};
d.AT=function(){var a=this.un;this.un=(this.un+1)%9007199254740992;return a};d.x1=function(a,b){a=this.Ak.get(a);if(!a)return I(Error("Unknown route"));var c=this.Mt(a.Tr);c.receiverType=chrome.cast.io.DIAL;c=new uj("custom_dial_launch",new chrome.cast.$y(c,a.De.state,a.De.extraData));c.clientId=b;c.sequenceNumber=this.AT();this.cw.add(c.sequenceNumber);this.C.Qd(this,a.Ea.id,c);return H()};d.Zf=function(a){return this.Ka.Zf(a)};d.Xl=function(a){return this.Ka.Xl(a)};
d.ql=function(a,b){return this.Ka.ql(a,b)};d.Ti=function(a,b){return this.Ka.Ti(a,b)};d.$g=function(a,b,c,e,f){return this.Ka.$g(a,b,c,e,f)};d.Hh=function(a,b,c,e,f,g){return this.Ka.Hh(a,b,c,e,f,g)};d.Pf=function(a){var b=this.Ak.get(a);this.Ak.remove(a);b&&b.HE?this.Ka.tc(a):this.Ka.Pf(a)};d.pc=function(){this.C.pc()};d.onSinkAvailabilityUpdated=function(a,b){this.C.onSinkAvailabilityUpdated(a,b)};d.lk=function(a,b){this.C.lk(this,b)};d.Wh=function(a,b){this.C.Wh(this,b)};
d.Xh=function(a,b){this.C.Xh(this,b)};d.Qd=function(a,b,c){this.C.Qd(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.C.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.C.onPresentationConnectionClosed(a,b,c)};d.Xu=function(a){return this.C.Xu(a)};d.av=function(){return this.C.av()};d.Ve=function(){return this.C.Ve()};d.Rq=function(a,b,c){this.C.Rq(this,b,c)};d.zw=function(a){this.C.zw(a)};d.Yh=function(a){this.Ka.Yh(a)};d.ff=function(a){this.Ka.ff(a)};
d.Qc=function(a){this.Ka.Qc(a)};d.Jn=function(){};d.rf=function(a,b){return this.Ka.rf(a,b)};d.ix=function(a){this.C.ix(a)};d.Ev=function(){return this.C.Ev()};var rl=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,rl);else if(b=Error().stack)this.stack=b;this.errorCode=a};u(rl,Error);var sl=function(a,b){this.routeId=a;this.message=b};var tl=function(a){this.$j=a;this.lf=new Ak};d=tl.prototype;d.enqueue=function(a){this.lf.N()==this.$j&&this.lf.Of();this.lf.enqueue(a)};d.Of=function(){return this.lf.Of()};d.jP=function(){var a=this.lf.A();this.lf.clear();return a};d.Db=function(){return this.lf.Db()};d.MW=function(){return this.lf.N()==this.$j};d.A=function(){return this.lf.A()};var ul=function(){this.uk={};this.Vj={};this.a=C("mr.MrRouteMessageSender")};d=ul.prototype;d.fw=function(a){if(this.fE(a))return H(this.lT(a));var b=J();this.Vj[a]=b;return b.promise};d.qy=function(a){(a=this.px(a))&&a.resolve([])};d.send=function(a,b){if(!this.JX(a,b)){var c=this.uk[a];c||(c=new tl(50),this.uk[a]=c);c.MW()&&(E(this.a,"Queue is full; dropping oldest message"),G(this.a,"   for route "+a));c.enqueue(new sl(a,b))}};d.Wh=function(a){delete this.uk[a];(a=this.px(a))&&a.reject(Error("Route closed"))};
d.fE=function(a){return!!this.uk[a]&&!this.uk[a].Db()};d.lT=function(a){return(a=this.uk[a])&&!a.Db()?a.jP():[]};d.px=function(a){var b=this.Vj[a];b&&delete this.Vj[a];return b||null};d.JX=function(a,b){var c=this.px(a);c&&c.resolve([new sl(a,b)]);return!!c};var vl={jz:0,Zy:1},wl=function(a){kh("MediaRouter.CastStreaming.Start.Success",a,vl)};var xl=C("mr.mirror.cast.LogUploader"),zl=function(a,b,c){yl("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},yl=function(a,b,c,e){if(0==b.size)F(xl,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);dg("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.kd()?(b=a.Gj(),F(xl,"Upload to Crash succeeded: "+
b)):F(xl,"Upload to Crash failed. HTTP status: "+a.Qa());e&&e(b)},"POST",f,void 0,3E4)}};var Al=function(){this.sm=0};za(Al);var Bl=C("mr.mirror.cast.LogUtils");Al.prototype.h6=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=t();return this.sm&&b&&c-this.sm<b?!1:Math.random()<a.fraction};
var Cl=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=pi;this.senderPlatform=bd;this.senderUserAgent=hc||""},Dl=function(a,b,c,e){var f=new Cl;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.WS();f.minResolution=c.mT();f.resolutionChangePolicy=c.mU();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;
f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&(f.Dja=e);return f},El=function(a,b,c,e,f){F(Bl,"getRawEvents");var g=J(),k=function(b){F(Bl,"Got receiver version: "+b);b=JSON.stringify(Dl(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,function(a){g.resolve(a)})};"Chromecast"==c?lg(b).then(k,g.reject):k(null);return g.promise},Fl=function(a,b,c,e){F(Bl,"getStats");var f=J(),g=function(b){F(Bl,"Got receiver version: "+
b);var g=Dl(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Zb(b,a);f.resolve(b)})};"Chromecast"==c?lg(b).then(g,f.reject):g(null);return f.promise};Al.prototype.Ra=function(){return"mirror.cast.LogUtils"};Al.prototype.getData=function(){return[null,{lastAutoSubmitMillis:this.sm}]};Al.prototype.vb=function(){var a=of(this);this.sm=a&&a.lastAutoSubmitMillis||0};var Gl=function(a,b){di.call(this,a,b)};u(Gl,di);var Hl=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},Il=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var Jl=C("mr.NetworkUtils"),Kl=function(a,b){if(!Yh)return I("TDLS feature not enabled.");var c=J();chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(Jl.ea("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),c.reject("Unable to set TDLS state to "+b+".")):(Jl.info("TDLS state changed: state = "+b+", status = "+a),c.resolve(a))});return c.promise};var Ll=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var Ml=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var Nl=function(a,b){this.address=a;this.port=b},Ol=function(a,b){vh.call(this,b);this.a=C("mr.mirror.cast.Session");this.mk=a;this.Da=a.Zf().clone();this.Od=$g.Ju(b.id);this.H=b.pe.sessionId;this.rd=new Nl(b.pe.AJ,2344);this.jr=b.pe.BJ;this.uc=null;this.Tg=!1;this.Mb=null;this.Ii=!1;this.Jg=0;this.Ca=this.po=this.qo=null;this.d0=["H264","VP8"];this.wv=new A;this.Sz=null;this.MH=r(this.IZ,this);this.LH=r(this.HZ,this);this.am=null;this.$m=new gi(30);this.eH=!1;this.Zk=null;this.Ex=new Zi("mirror.cast.SeqNumGenerator");
this.Ec=this.ne=null};u(Ol,vh);d=Ol.prototype;
d.start=function(a){var b=Hl(a);a=Il(a);this.ne=new bh("MediaRouter.CastStreaming.Session.Launch");this.Ca=J();this.tW();this.Da.useTdls&&Kl(this.rd.address,!0).then(function(a){"Connected"!=a&&(this.Da.useTdls=!1)},function(){this.Da.useTdls=!1},this);chrome.cast.streaming.session.create(b,a,r(function(a,b,f){this.uc=a;this.Mb=b;this.Jg=f;this.Od.onMessage=r(this.Sq,this);this.Dx({type:"OFFER",sessionId:this.getId(),seqNum:this.Ex.Op(),offer:this.yl()})},this));return this.Ca.promise};
d.stop=function(){this.Ec&&(this.Ec.end(),this.Ec=null);F(this.a,"Stopping "+this.getId());null!==this.uc&&(chrome.cast.streaming.rtpStream.stop(this.uc),chrome.cast.streaming.rtpStream.destroy(this.uc),this.uc=null,this.Tg=!1);null!==this.Mb&&(chrome.cast.streaming.rtpStream.stop(this.Mb),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null,this.Ii=!1);this.Jg&&(chrome.cast.streaming.udpTransport.destroy(this.Jg),this.Jg=0);this.Da.useTdls&&Kl(this.rd.address,!1);this.Ca&&(this.Ca.resolve(this),
this.Ca=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.MH);chrome.cast.streaming.rtpStream.onError.removeListener(this.LH);null!==this.am&&(window.clearTimeout(this.am),this.am=null);this.qo=this.po=null;if(this.Zk&&this.Zk.onSessionStop)this.Zk.onSessionStop(this.rd);return!0};d.i4=function(a){this.Tg&&chrome.cast.streaming.rtpStream.toggleLogging(this.uc,a);this.Ii&&chrome.cast.streaming.rtpStream.toggleLogging(this.Mb,a)};
d.getLogs=function(){if(!this.Tg&&!this.Ii)return I(Error("No streams has been started yet."));var a=[];if(this.Tg){var b=El(this.uc,this.rd.address,this.jr,this.Da,this.$m.A());a.push(b)}this.Ii&&(b=El(this.Mb,this.rd.address,this.jr,this.Da,this.$m.A()),a.push(b));return oe(a).then(function(a){a=new Blob(a,{type:"application/gzip"});F(this.a,"Events blob size: "+a.size);return a},null,this)};
d.getStats=function(){var a=[];if(this.Tg){var b=Fl(this.uc,this.rd.address,this.jr,this.Da);a.push(b)}this.Ii&&(b=Fl(this.Mb,this.rd.address,this.jr,this.Da),a.push(b));this.$m.N()&&a.push(H({receiverStatusData:this.$m.A()}));return oe(a).then(function(a){var b={};v(a,function(a){Zb(b,a)});return b})};
d.FO=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.uc)[0];a.payload.maxLatency=this.Da.maxLatencyMillis;"minLatency"in a.payload&&(a.payload.minLatency=this.Da.minLatencyMillis);"animatedLatency"in a.payload&&(a.payload.animatedLatency=this.Da.animatedLatencyMillis);a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.qo;a.payload.aesIvMask=this.po;return a};
d.TO=function(){var a=[];if(null===this.Mb)return a;var b=chrome.cast.streaming.rtpStream.getSupportedParams(this.Mb);this.d0.forEach(function(c){var e=qb(b,function(a){return a.payload.codecName.toLowerCase()==c.toLowerCase()},this);e&&(e.payload.maxFrameRate=this.Da.maxFrameRate,e.payload.minBitrate=this.Da.minVideoBitrate,e.payload.maxBitrate=this.Da.maxVideoBitrate,e.payload.maxLatency=this.Da.maxLatencyMillis,"minLatency"in e.payload&&(e.payload.minLatency=this.Da.minLatencyMillis),"animatedLatency"in
e.payload&&(e.payload.animatedLatency=this.Da.animatedLatencyMillis),e.payload.aesKey=this.qo,e.payload.aesIvMask=this.po,e.payload.ssrc=Math.floor(499999*Math.random())+500001,e.payload.feedbackSsrc=12,e.payload.payloadType=96,a.push(e))},this);return a};
d.yl=function(){var a=0,b=[];if(this.uc){var c=this.FO();this.Sz=c;c={index:a,type:"audio_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Da.maxLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,bitRate:128E3,sampleRate:c.payload.clockRate,timeBase:"1/"+c.payload.clockRate,channels:c.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Da.enableLogging&&Zb(c,{receiverRtcpEventLog:!0});
this.Da.dscpEnabled&&Zb(c,{receiverRtcpDscp:46});b.push(c);a++}this.TO().forEach(function(c){var f={index:a,type:"video_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Da.maxLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,maxFrameRate:Math.round(1E3*c.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:c.payload.maxBitrate,resolutions:[{width:this.Da.maxWidth,height:this.Da.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};this.Da.enableLogging&&Zb(f,{receiverRtcpEventLog:!0});this.Da.dscpEnabled&&Zb(f,{receiverRtcpDscp:46});b.push(f);this.wv.set(a,c);a++},this);return{supportedStreams:b}};d.IZ=function(a){a==this.uc?this.Tg=!0:a==this.Mb&&(this.Ii=!0);this.Tg&&(null===this.Mb||this.Ii)&&(this.i4(this.Da.enableLogging),this.Ca&&(this.Ca.resolve(this),this.Ca=null));this.Ec=new gh("MediaRouter.CastStreaming.Session.Length")};
d.HZ=function(a,b){if(a==this.uc)E(this.a,"Audio stream error "+b);else if(a==this.Mb)E(this.a,"Video stream error "+b);else{E(this.a,"Error for stream "+a+": "+b);return}this.Ca&&(this.Ca.reject(Error("Error for stream "+a+": "+b)),this.Ca=null);this.stop()};
d.E6=function(a,b){G(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.Jg,receiverIpEndPoint:this.rd,"audio ID":this.uc,"video ID":this.Mb,"audio params":a,"video params":b}));if(Ea(chrome.cast.streaming.udpTransport.N4)){var c={};this.Da.dscpEnabled&&(F(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.N4(this.Jg,c)}chrome.cast.streaming.udpTransport.setDestination(this.Jg,{address:this.rd.address,port:this.rd.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.MH);
chrome.cast.streaming.rtpStream.onError.addListener(this.LH);a&&chrome.cast.streaming.rtpStream.start(this.uc,a);b&&chrome.cast.streaming.rtpStream.start(this.Mb,b)};
d.Sq=function(a){if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){a=a.data;G(this.a,a);var b=JSON.parse(a);if("ANSWER"==b.type&&"ok"==b.result){b.answer.udpPort&&(this.rd.port=b.answer.udpPort);this.eH=!!b.answer.receiverGetStatus;if(this.Zk&&this.Zk.onAnswer)this.Zk.onAnswer(this.rd);this.ne&&(this.ne.end(),this.ne=null);F(this.a,"Starting streaming");var c=this.Sz,e=null;b.answer.sendIndexes&&b.answer.sendIndexes.forEach(function(a){c&&0==a?b.answer.ssrcs&&b.answer.ssrcs[a]&&(c.payload.feedbackSsrc=
b.answer.ssrcs[a]):this.wv.Oa(a)&&(e?E(this.a,"Receiver selected multiple video stream"):(e=this.wv.get(a),b.answer.ssrcs&&b.answer.ssrcs[a]&&(e.payload.feedbackSsrc=b.answer.ssrcs[a])))},this);null!==this.Mb&&null===e&&(E(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null);if(c||e){this.pD();this.E6(c,e);this.Ca&&(this.Ca.resolve(this),this.Ca=null);return}}if("STATUS_RESPONSE"!=b.type||
null===b.status)this.Ca&&(this.Ca.reject(Error("Invalid answer: "+b)),this.Ca=null),this.stop();else{a={};for(var f in b.status){var g=b.status[f];Ca(g)&&g.length?a[f]=g.pop():a[f]=g}f={};f[(new Date).toISOString()]=a;this.$m.add(f)}}};d.tW=function(){this.po=Ff(window.crypto.getRandomValues(new Uint8Array(16)));this.qo=Ff(window.crypto.getRandomValues(new Uint8Array(16)))};d.XH=function(){this.Dx(this.UT())};d.Dx=function(a){this.Od.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};
d.pD=function(){this.am=null;if(this.Jg&&this.eH){var a=new Ml(this.getId(),this.Ex.Op(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.Dx(a);this.am=window.setTimeout(r(this.pD,this),12E4)}};d.UT=function(){var a=new Ll(this.H,this.Ex.Op());a.title=this.mx||void 0;a.icons=this.iconUrl&&!this.pq?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.H};d.Cj=function(){return this.mk};d.K=function(){this.Od.ib();this.stop()};var Pl=function(a){uh.call(this,"cast_streaming",a)};u(Pl,uh);d=Pl.prototype;d.getName=function(){return"cast_streaming"};d.Cj=function(a,b){return new Gl(a,b)};d.Nt=function(a,b){if(a instanceof Gl)return new Ol(a,b);throw Error("Invalid parameters");};d.gx=function(){wl(0)};d.cx=function(){wl(1)};d.dx=function(){jh("MediaRouter.CastStreaming.Session.End")};d.ex=function(a){kh("MediaRouter.CastStreaming.Start.Failure",a,lh)};d.fx=function(){jh("MediaRouter.CastStreaming.Stream.End")};
d.Yz=function(){var a=this.Pa,b=a.getLogs().then(function(a){return a},function(a){E(this.m,"Get cast streaming logs failed.",a)},this),a=a.getStats().then(function(a){return a},function(a){E(this.m,"Get cast streaming stats failed.",a)},this),c=J();chrome.metricsPrivate.getIsCrashReportingEnabled(function(a){c.resolve(a)});return oe([b,a,c.promise]).then(function(a){var b=a[0],c=new FileReader;c.onloadend=function(){xf("mr.temp.mirror.cast.Service.mirrorLogs",c.result)};c.readAsBinaryString(b);var k=
a[1];a[2]&&(b&&Al.O().h6()?zl(b,void 0,this.uY.bind(this)):k&&yl("stats.json",new Blob([JSON.stringify(k)],{type:"application/json"}),void 0,void 0))},null,this)};d.uY=function(a){a&&(Al.O().sm=t())};d.pT=function(a){F(this.m,"Received message to upload logs for "+a);return this.Pa?this.Pa.getLogs().then(function(b){return zl(b,a)},function(b){E(this.m,"Get cast streaming logs failed.",b);return this.AF(a)},this):H(this.AF(a))};
d.AF=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");F(this.m,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return zl(new Blob([c],{type:"application/gzip"}),a)};var Ql={jz:0,Zy:1},Rl=function(a){kh("MediaRouter.WebRtc.Start.Success",a,Ql)};var Tl=function(a,b){ve.call(this);this.a=Qd("cv2.PeerConnection");this.OX=Sl;this.o=this.MO(b);this.$O=this.HO(a);this.HP=!0;this.cI=J();this.Fx=!1;this.Oq=0;this.hq=null;this.PE=this.tw=0;this.sc=!1;this.ZF=this.$F=this.vw=this.gG=this.BY=ya};u(Tl,ve);var Sl={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Ul={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};d=Tl.prototype;d.H4=function(a){this.vw=a};d.G4=function(a){this.$F=a};d.F4=function(a){this.ZF=a};
d.J4=function(a){this.gG=a};d.I4=function(a){this.$O.onmessage=function(b){a(b.data)}};d.Iv=function(){return this.sc};d.LT=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.MO=function(a){a=this.LT(a);var b=new webkitRTCPeerConnection(a);b.onicecandidate=r(this.xw,this);b.Aia=r(this.QY,this);b.oniceconnectionstatechange=r(this.PY,this);F(this.a,"Created webkitRTCPeerConnnection with config: "+JSON.stringify(a));return b};
d.HO=function(a){return this.o.createDataChannel(a,{reliable:!1})};d.start=function(){this.sc||(this.sc=!0,this.yl())};d.stop=function(){F(this.a,"Stopping peer connection...");this.sc&&(this.sc=!1,"closed"!=this.o.signalingState&&this.o.close())};d.addStream=function(a){this.o.addStream(a)};d.removeStream=function(a){this.sc&&this.o.removeStream(a)};d.K=function(){this.stop();this.o=null};
d.yl=function(){F(this.a,"Sending offer to peer.");var a=this;this.tw=t();this.o.createOffer(r(this.KI,this),function(b){E(a.a,"Error creating offer: "+JSON.stringify(b))},this.OX);this.cI.promise.then(function(b){a.gG(b)})};d.KI=function(a){F(this.a,"Setting local description: "+JSON.stringify(a));var b=this;this.o.setLocalDescription(a,function(){F(b.a,"Local description set successfully")},function(a){E(b.a,"Error setting local description: "+JSON.stringify(a))})};
d.uQ=function(a){return{type:a.type,sdp:a.sdp}};d.setRemoteDescription=function(a){G(this.a,"<===: "+JSON.stringify(a));a=new RTCSessionDescription(a);F(this.a,"Setting remote description: "+JSON.stringify(a));var b=this;this.o.setRemoteDescription(a,function(){F(b.a,"Remote description set successfully.")},function(a){E(b.a,"Error setting remote description: "+JSON.stringify(a))})};
d.xw=function(a){var b=this;a.candidate?(this.Oq++,this.PE=t(),1==this.Oq?this.hq=df(function(){F(b.a,"ICE candidate gathering timed out.");b.hq=null;b.wx()},5E3):this.Fx&&E(this.a,"Received ICE candidate after resolving session description.")):(F(this.a,"End of ICE candidates."),dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",t()-this.tw),this.wx(),0<this.Oq&&dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.PE-this.tw))};
d.QY=function(){"completed"==this.o.iceGatheringState&&this.wx()};d.wx=function(){ef(this.hq);this.hq=null;this.Fx||(F(this.a,"Resolving sesion description after gathering "+this.Oq+" ICE candidates."),this.cI.resolve(this.uQ(this.o.localDescription)),this.Fx=!0)};
d.PY=function(a){if(this.o){var b=this.o.iceConnectionState;F(this.a,"New ICE connection state: "+b+".");if("connected"==b)this.vw("iceconnected");else if("completed"==b)this.vw("icecompleted");else if("failed"==b)E(this.a,"Ice connection failed: "+JSON.stringify(a)),this.$F("icefailed");else if("closed"==b)this.ZF("iceclosed");else if("disconnected"==b)if(E(this.a,"Ice connection state is bad."),this.HP&&this.Iv()){F(this.a,"Restarting ICE.");var c=this;this.o.createOffer(r(this.KI,this),function(a){E(c.a,
"Error creating new offer: "+JSON.stringify(a))},Ul)}else this.BY()}};var Vl=function(a,b){vh.call(this,b);this.mk=a;this.LG=J();this.o=this.LG.promise;this.Od=$g.Ju(b.id);this.Ca=J();this.Cv=this.sc=!1;this.Ec=this.ne=null;this.cy();this.S5();this.Cc(new wh("GET_TURN_CREDENTIALS"))};u(Vl,vh);d=Vl.prototype;d.start=function(a){var b=this;return this.o.then(function(c){if(c.Iv())return I(Error("Mirroring already started"));b.ne=new bh("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.Ca.promise})};
d.stop=function(){this.Ec&&this.Ec.end();this.Cv=this.sc=!1;this.ne=this.Ec=null;this.o.then(function(a){a.stop()});return!0};d.K=function(){this.Od.ib();this.stop()};
d.cy=function(){var a=this;this.Od.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.LG.resolve(new Tl(a.Ea.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.Cv=!0;a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.Ca.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}}};
d.S5=function(){var a=this;this.o.then(function(b){b.J4(function(b){b=new yh(a.mk.Zf(),Sl,b);a.Cc(new wh("OFFER",b))});b.I4(function(b){a.Cc(xh(b))});b.H4(function(){a.sc=!0;a.Cc(new wh("SESSION_START_SUCCESS"));!a.Cv&&a.ne&&a.ne.end();a.ne=null;a.Ec=new gh("MediaRouter.WebRtc.Session.Length");a.Ca.resolve(a)});b.F4(function(){a.Cc(new wh("SESSION_END"))});b.G4(function(b){a.sc||a.Ca.reject(b);a.Cc(new wh("SESSION_FAILURE"))})})};var Wl={channelType:"cloud"};
Vl.prototype.Cc=function(a){this.Od.sendMessage(a,Wl)};Vl.prototype.Cj=function(){return this.mk};var Xl=function(a){uh.call(this,"webrtc",a)};u(Xl,uh);d=Xl.prototype;d.Cj=function(a,b){return new di(a,b)};d.Nt=function(a,b){if(a instanceof di)return new Vl(a,b);throw Error("Invalid parameters");};d.gx=function(){Rl(0)};d.cx=function(){Rl(1)};d.dx=function(){jh("MediaRouter.WebRtc.Session.End")};d.ex=function(a){kh("MediaRouter.WebRtc.Start.Failure",a,lh)};d.fx=function(){jh("MediaRouter.WebRtc.Stream.End")};var Yl=function(a,b,c){ve.call(this);this.qX=null!=c?r(a,c):a;this.hg=b;this.pl=r(this.RZ,this);this.bt=[]};u(Yl,ve);d=Yl.prototype;d.Pk=!1;d.Rm=0;d.Bb=null;d.ou=function(a){this.bt=arguments;this.Bb||this.Rm?this.Pk=!0:this.Yt()};d.stop=function(){this.Bb&&(ef(this.Bb),this.Bb=null,this.Pk=!1,this.bt=[])};d.pause=function(){this.Rm++};d.resume=function(){this.Rm--;this.Rm||!this.Pk||this.Bb||(this.Pk=!1,this.Yt())};d.K=function(){Yl.R.K.call(this);this.stop()};
d.RZ=function(){this.Bb=null;this.Pk&&!this.Rm&&(this.Pk=!1,this.Yt())};d.Yt=function(){this.Bb=df(this.pl,this.hg);this.qX.apply(null,this.bt)};var $l=function(a){this.La={};if(a)for(var b=0;b<a.length;b++)this.La[Zl(a[b])]=null;for(var c in Object.prototype)hb(c+" should not be enumerable in Object.prototype.")},am={},Zl=function(a){return a in am||32==String(a).charCodeAt(0)?" "+a:a},bm=function(a){return 32==a.charCodeAt(0)?a.substr(1):a};d=$l.prototype;d.add=function(a){this.La[Zl(a)]=null};d.oz=function(a){for(var b=0;b<a.length;b++)this.La[Zl(a[b])]=null};d.HM=function(a){for(var b in a.La)this.La[b]=null};
d.clear=function(){this.La={}};d.clone=function(){var a=new $l;a.HM(this);return a};d.contains=function(a){return Zl(a)in this.La};d.equals=function(a){return this.tq(a)&&a.tq(this)};d.forEach=function(a,b){for(var c in this.La)a.call(b,bm(c),void 0,this)};d.N=Object.keys?function(){return Object.keys(this.La).length}:function(){var a=0,b;for(b in this.La)a++;return a};d.A=Object.keys?function(){return Object.keys(this.La).map(bm,this)}:function(){var a=[],b;for(b in this.La)a.push(bm(b));return a};
d.Db=function(){for(var a in this.La)return!1;return!0};d.tq=function(a){for(var b in this.La)if(!(b in a.La))return!1;return!0};d.remove=function(a){a=Zl(a);return a in this.La?(delete this.La[a],!0):!1};d.xd=function(){return Fc(this.A())};var cm=function(){this.bc=null;this.a=C("mr.IssueSenderImpl")};cm.prototype.init=function(a){this.bc=a};cm.prototype.send=function(a){if(this.bc)if(this.bc.onIssue)this.bc.onIssue(a);else D(this.a,"MediaRouterService.onIssue not defined.");else D(this.a,"MediaRouterService is not set.")};var dm=new Sc;var em=function(a,b){K.call(this,"internal_message");this.routeId=a;this.message=b};u(em,K);var fm=function(a,b,c){ve.call(this);this.IH=a;this.se=b;this.WX=c;this.onMessage=ya;c.listen("internal_message",this.Sq,!1,this)};u(fm,ve);fm.prototype.sendMessage=function(a,b){return this.se(this.IH,a,b)};fm.prototype.Sq=function(a){if(a.routeId==this.IH)this.onMessage(a.message)};fm.prototype.K=function(){this.WX.Xc("internal_message",this.Sq,!1,this)};var gm=new fm("",function(){return H()},new M),hm=function(a){this.C=a};
hm.prototype.Ju=function(a){var b=this.C.Xu(a);return b?new fm(a,r(b.Cg,b),this.C.av()):gm};var im=function(){this.a=C("mr.ProviderManager");this.Rc=[];this.Tc=new A;this.pn=new A;this.we=new $l;this.ni=new $l;this.fk=new A;this.bc=null;this.Qk=!1;this.JH=new M;this.KH=new Yl(this.y2,500,this);this.q6=new Yl(this.WP,500,this);this.Im=new ul;this.Rw=0;this.IE=new cm;this.Rk=new A;this.Lq=-1==window.navigator.userAgent.indexOf("Windows");this.Kq=[];this.createRoute=this.fe;this.joinRoute=this.Hh;this.connectRouteByRouteId=this.$g;this.closeRoute=this.terminateRoute=this.tc;this.startObservingMediaSinks=
this.Bi;this.stopObservingMediaSinks=this.Di;this.sendRouteMessage=this.Cg;this.sendRouteBinaryMessage=this.x2;this.listenForRouteMessages=this.fw;this.stopListeningForRouteMessages=this.qy;this.startObservingMediaRoutes=this.Ai;this.stopObservingMediaRoutes=this.Ci;this.onPresentationSessionDetached=this.detachRoute=this.Pf;this.enableMdnsDiscovery=this.pB;this.searchSinksAndCreateRoute=this.l2;this.searchSinks=this.rf;this.updateMediaSinks=this.z7};d=im.prototype;d.oT=function(a){return this.fk.get(a).Bm().then(function(a){return a})};
d.V0=function(a){a.forEach(this.Y0,this)};d.jd=function(a,b){this.fk.set("webrtc",new zh(new Xl(this)));this.fk.set("cast_streaming",new zh(new Pl(this)));var c=Vh.O();c.p4(this);this.fk.set("hangouts",c);c=new hm(this);$g||($g=c);this.bc=a;this.IE.init(a);this.V0(b);qf(this)};
d.Y0=function(a){if(this.Qp(a.getName()))E(this.a,"Provider "+a.getName()+" already registered.");else try{a.jd(),this.Rc.push(a),this.Rk.set(a.getName(),0)}catch(b){E(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};
d.Rn=function(a,b){var c=this,e=new Promise(function(e,g){var k=null;b&&(c.g0(),k=window.setTimeout(function(){k=null;g(new rl(1,"timeout after "+b+" ms."));a.cancel()},b));a.then(function(a){null!=k&&window.clearTimeout(k);e(a)},function(a){null!=k&&window.clearTimeout(k);g(a instanceof rl?a:new rl(0,a.message,a.stack))})});b&&(e=e.then(function(a){c.Gz();return a},function(a){c.Gz();throw a;}));return e};d.g0=function(){this.Rw++;this.Fm()};d.Gz=function(){this.Rw--;this.Fm()};
d.fe=function(a,b,c,e,f,g,k){var p=this,w=this.XT(a,b);if(!w)return Promise.reject(new rl(2,"No provider supports createRoute with source: "+a+" and sink: "+b));dm.add(b);this.pc();g=g&&0<g?g:6E4;a=w.fe(a,b,c,k||!1,g,e,f);return this.Rn(a,g).then(function(a){dm.remove(b);p.pc();return a},function(a){D(p.a,"Error creating route.",a);dm.remove(b);p.pc();throw a;})};
d.$g=function(a,b,c,e,f,g){var k=this.Tc.get(b);if(!k)return Promise.reject(new rl(2,"No provider supports join "+b));a=k.$g(a,b,c,e,f);return this.Rn(a,g&&0<g?g:3E4)};d.Hh=function(a,b,c,e,f,g){var k=this.WT(a);if(!k)return Promise.reject(new rl(2,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.Hh(a,b,g||!1,f,c,e);return this.Rn(a,f)};d.tc=function(a){var b=this.Tc.get(a);b?this.zF(a).Ab(function(){b.tc(a)}):E(this.a,"Route "+a+" does not exist.")};
d.Bi=function(a){this.we.contains(a)||(this.we.add(a),this.Rc.forEach(function(b){b.Bi(a)}));this.fr(a)};d.Di=function(a){this.we.remove(a)?this.lB(a):F(this.a,"No existing query "+a)};d.lB=function(a){this.Rc.forEach(function(b){b.Di(a)})};
d.fr=function(a){if("urn:x-org.chromium.media:source:tab:-1"==a)E(this.a,"No sinks for sourceUrn: "+a);else{var b=new A,c=[];this.Rc.forEach(function(e){var f=e.Ol(a);0<f.sinks.length&&(c=f.origins);f.sinks.forEach(function(a){b.Oa(a.id)?E(this.a,"Detected duplicate sink "+a.id+" from provider: "+e.getName()):b.set(a.id,a)},this)},this);this.z2(a,b.A(),c||[])}};d.z2=function(a,b,c){F(this.a,"Sending "+b.length+" sinks to MR for "+a);jm(b);this.bc.onSinksReceived(a,b,c)};
var jm=function(a){a.forEach(function(a){a.isLaunching_=dm.contains(a.id)})};d=im.prototype;d.Cg=function(a,b,c){var e=this.Tc.get(a);return e?this.Rn(e.Cg(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.x2=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.fw=function(a){return this.Tc.Oa(a)?this.Rn(this.Im.fw(a)):Promise.reject(Error("Invalid route ID"))};d.qy=function(a){this.Im.qy(a)};
d.Pf=function(a){var b=this.Tc.get(a);b?b.Pf(a):F(this.a,"Route "+a+" does not exist.")};d.pB=function(){this.Lq=!0;this.Kq.forEach(function(a){a()});this.Kq.length=0;var a=this;this.we.forEach(function(b){a.fr(b)})};d.XT=function(a,b){return this.Rc.find(function(c){return c.ql(a,b)})||null};d.WT=function(a){return this.Rc.find(function(b){return b.Ti(a)})||null};d.WP=function(){this.we.forEach(function(a){this.fr(a)},this)};d.Fm=function(){this.bc.setKeepAlive(this.hW()||0<this.Rw)};
d.Ai=function(a){this.ni.contains(a)||(this.Qk=!0,this.ni.add(a),this.Rc.forEach(function(b){b.Ai(a)}));this.KH.ou();this.Fm()};d.Ci=function(a){this.ni.remove(a)?(0==this.ni.length&&(this.Qk=!1),this.Rc.forEach(function(b){b.Ci(a)}),this.Fm()):F(this.a,"No existing route query "+a)};
d.y2=function(){if(this.Qk){var a=[];this.Rc.forEach(function(b){a=a.concat(b.Ye())});this.ni.forEach(function(b){var c=[];this.Rc.forEach(function(a){a.Ye().forEach(function(f){!f.ej&&a.Ti(b,f)&&c.push(f.id)})});this.bc.onRoutesUpdated(a,b,c)},this)}};var km=function(a,b,c,e,f,g,k){this.p6=b;this.Z1=c;this.k6=e;this.HH=f;this.o6=g;this.NX=k};d=im.prototype;d.Ra=function(){return"ProviderManager"};
d.getData=function(){var a={};this.Tc.forEach(function(b,c){a[c]=b.getName()});return[new km(this.Rc.map(function(a){return a.getName()}),this.we.A(),this.ni.A(),this.Qk,a,this.Rk.b(),this.Lq)]};d.vb=function(){var a=nf(this);if(a){this.we.oz(a.p6);this.ni.oz(a.Z1);this.Qk=a.k6;for(var b in a.HH){var c=this.Qp(a.HH[b]);this.Tc.set(b,c)}this.Rk.addAll(a.o6);a.NX&&this.pB()}};d.Xu=function(a){return this.Tc.get(a)};d.lk=function(a,b){this.Tc.set(b.id,a);this.Xh(a,b)};
d.Wh=function(a,b){this.zF(b.id);var c=this,e=function(){c.Tc.remove(b.id);c.Im.Wh(b.id);c.Xh(a,b)};this.Im.fE(b.id)?df(e,50,this):e()};d.Xh=function(){this.Fm();this.Qk&&this.KH.ou()};d.fG=function(a){var b=this.Tc.get(a.id);b&&this.Xh(b,a)};d.Qd=function(a,b,c){this.Tc.Oa(b)?this.Im.send(b,JSON.stringify(c)):E(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.bc.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.bc.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.bc.onPresentationConnectionClosed(a,b,c)};d.zw=function(a){this.pn.remove(a);var b=this.Tc.get(a);b&&b.tc(a)};d.Rq=function(a,b,c){this.JH.dispatchEvent(new em(b,c))};d.pc=function(){this.q6.ou()};
d.onSinkAvailabilityUpdated=function(a,b){if("function"==typeof this.bc.onSinkAvailabilityUpdated&&this.Rk.get(a.getName())!=b){var c=this.KA();this.Rk.set(a.getName(),b);a=this.KA();c!=a&&(this.bc.onSinkAvailabilityUpdated(a),0==a&&(this.we.forEach(function(a){this.lB(a)},this),this.we.clear()))}};d.KA=function(){return this.Rk.A().reduce(function(a,b){return Math.max(a,b)},0)};d.av=function(){return this.JH};d.Ve=function(){return this.IE};d.hW=function(){return this.Rc.some(function(a){return a.Ye().some(function(a){return a.isLocal})})};
d.zF=function(a){if(this.pn.Oa(a)){var b=this;return this.fk.get(this.pn.get(a)).Bm().then(function(c){b.pn.remove(a);return c.NJ()})}return H(!1)};d.Jn=function(a,b,c){var e=a.Xl(b.sinkId);this.pn.set(b.id,e);return this.fk.get(e).Bm().then(function(e){return e.Jn(b,b.mediaSource,a.Zf(b.sinkId),c)})};d.ix=function(a){this.Lq?a():-1==this.Kq.indexOf(a)&&this.Kq.push(a)};d.Ev=function(){return this.Lq};d.Qp=function(a){return this.Rc.find(function(b){return b.getName()==a})||null};
d.lD=function(a){return a.startsWith("pseudo:")?a.substring(7):null};d.l2=function(a,b,c,e,f,g,k,p){var w=this.lD(a),w=w?this.Qp(w):null,B=null;w&&(B=w.rf(b,c));if(B)return this.bc.onSearchSinkIdReceived(a,B.id),this.fe(b,B.id,e,f,g,k,p);this.bc.onSearchSinkIdReceived(a,"");return Promise.reject(new rl(0,"No sink found for search input: "+c.input+" and source: "+b))};d.rf=function(a,b,c){a=(a=this.lD(a))?this.Qp(a):null;var e=null;a&&(e=a.rf(b,c));return e?e.id:""};
d.z7=function(a){this.we.contains(a)||this.fr(a)};var lm={k8:0,DENIED:1,TIMEOUT:2},mm={fz:0,A9:1},nm={jM:0,NL:1,tba:2,R9:3,Q9:4,z$:5,TIMEOUT:6},om={O9:0,Raa:1},pm={$$:0,t$:1,iba:2,J9:3},qm=function(a){kh("MediaRouter.Cloud.Knock.Result",a,lm)},rm=function(a){kh("MediaRouter.Cloud.Session.Start",a,mm)},sm=function(a){kh("MediaRouter.Cloud.Session.Type",a,om)},tm=function(a){kh("MediaRouter.Cloud.Device.UserRole",a,pm)};var um=function(a,b,c,e,f,g){this.KE=a;this.Vc=b;this.oj=e||null;this.bk=c||null;this.Zd=f||null;this.ji=g||null};d=um.prototype;d.Vf=function(){var a="";this.Zd?a=this.Zd:this.bk&&(a=this.bk);return a};d.getId=function(){return this.KE+"@"+this.Vc};d.getService=function(){return this.Vc};d.Wf=function(){return this.oj};d.merge=function(a){!this.ji&&a.ji&&(this.ji=a.ji);!this.Zd&&a.Zd&&(this.Zd=a.Zd);this.Zd&&a.Zd&&this.ji&&(this.Zd=a.Zd)};var vm=function(a,b){this.Rg=a;this.n7=b},wm=new vm("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),xm=new vm("https://www.googleapis.com/calendar/v3",""),ym=new vm("https://www.googleapis.com/hangouts/v1",""),zm=new vm("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Am=function(a,b){this.rb=a;this.Hb=b;this.a=C("mr.cloud.calendar.CalendarService")};d=Am.prototype;d.rQ=function(){var a=this;return this.rR(this.Hb.$d,9E5).then(function(b){F(a.a,a.VB(b.length)+" events discovered before filtering.");return a.sS(b)},function(b){E(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.VB=function(a){return 20<a?"20+":a.toString()};d.rR=function(a,b){var c=t(),e=this;return this.VQ(a,new Date(c),new Date(c+b)).then(function(a){return a.filter(e.RW)})};
d.RW=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.VQ=function(a,b,c){a=this.rb.qj(xm.Rg,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});G(this.a,"Retrieving Hangouts from Calendar: "+a);return this.rb.Ug(a,"GET").then(function(a){return a.items?a.items:[]})};
d.sS=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var f=new xj(e.hangoutLink),g=b.u_(f.pd);if(2==g.length){var f=g[0],g=g[1],k,p;-1!=f.indexOf(".")&&(k=g,p=f);a.push(new um(g,f,k,p,e.summary))}else E(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);F(this.a,this.VB(a.length)+" events discovered with Hangout links.");return a};d.u_=function(a){return a.substring(12).split("/")};var Bm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},Cm=function(a){this.type=a},Dm=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};u(Dm,Cm);
var Em=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Fm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Gm=new Em("_stopSession",{},"viewer"),Hm=new Em("_startWebrtcSession",Fm),Im=new Em("_knockingStartWebrtcSession",Fm,"viewer");var Jm=function(a){this.ob=a;this.id=a.id;this.a=C("mr.cloud.devices.CloudDevice")};d=Jm.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.NW(),b=this.HW(),c=this.uA(864E5);G(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}c=this.uA(9E5);F(this.a,"Availability for legacy receiver app: "+c);return c};d.uA=function(a){var b=this.FS();return!!(b&&b>t()-a)};d.HW=function(){return"available"==this.getState().appStatus};
d.NW=function(){return"online"==this.ob.connectionStatus};d.FS=function(){return this.ob.lastUpdateTimeMs?Number(this.ob.lastUpdateTimeMs):null};d.Vf=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.ob.state._cloudCast};d.EE=function(){return this.ob.invitations?0!=this.ob.invitations.length:!1};var Km=function(a){this.rb=a};Km.prototype.getDevice=function(a){a=this.rb.qj(wm.Rg,["devices",a]);return this.rb.Ug(a,"GET").then(function(a){return new Jm(a)})};Km.prototype.nX=function(){return this.cF({descriptionSubstring:"Chrome Streaming Receiver"})};
Km.prototype.cF=function(a){var b=this,c=this.rb.qj(wm.Rg,["devices"],a);return this.rb.Ug(c,"GET").then(function(c){var f=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Jm(a)});if(c=c.nextPageToken){var g=Wb(a);g.token=c;return b.cF(g).then(function(a){return f.concat(a)})}return f})};Km.prototype.mX=function(){return this.nX().then(function(a){return a.filter(function(a){return a.isAvailable()&&!a.EE()})})};var Lm=function(a,b,c,e,f,g,k){var p=Rf.O().wp(a);this.oc=new Hi(p,b,g,k,f);this.deviceId=a;this.T6=c;this.qe=e};Lm.prototype.QJ=function(a){return sb(this.T6,a)};var Mm=function(a,b,c,e){Lm.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.Ms=c};u(Mm,Lm);var Nm=function(a){var b=a.getService();a.Wf()&&(b=a.Wf());var c;a.bk&&a.Vf()!=a.bk&&(c=a.bk);Lm.call(this,a.getId(),a.Vf(),["mesi"],"Hangout",b,"hangout",c);this.zH=a.ji||""};u(Nm,Lm);var Om=function(a,b){this.H7=a;this.ve=b;this.tf=new A;this.Ur=new A;this.vm=null},Pm=function(a,b,c){this.sinks=a;this.FA=b;this.NE=c};d=Om.prototype;d.kc=function(){this.LN()&&(this.vm=t(),this.Jl());return this.tf.A()};d.mo=function(a){this.tf.set(a.oc.id,a)};d.gn=function(a){return this.tf.remove(a)};d.W=function(a){return this.tf.get(a,null)};d.LN=function(){var a=this.vm+2E4;return null==this.vm||a<t()};d.Jl=function(){var a=this;return this.H7().then(function(b){a.G7(b)})};
d.G7=function(a){var b=new A(this.tf),c=new A,e=new A,f=[],g=[];a.forEach(function(a){var p=a.oc.id;c.set(p,a);e.set(p,a.deviceId);b.Oa(p)?b.Oa(p)&&JSON.stringify(b.get(p))!=JSON.stringify(a)&&g.push(a.oc):f.push(a.oc);b.remove(p)},this);a=b.ab().map(function(a){return b.get(a).oc});this.Ur.clear();this.Ur=e;this.tf.clear();this.tf=c;this.IN(f,g,a)};d.IN=function(a,b,c){0<a.length&&this.ve.sG(a);0<b.length&&this.ve.pc(b);0<c.length&&this.ve.ff(c)};
d.b=function(){return new Pm(this.tf.b(),this.Ur.b(),this.vm)};d.hF=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.qe?(e=c.deviceId.split("@"),e=new Nm(new um(e[0],e[1],c.oc.description,c.oc.domain,c.oc.friendlyName,c.zH))):"Chrome Streaming Receiver"==c.qe&&(e=new Mm(c.deviceId,c.oc.friendlyName,c.Ms,c.oc.domain));this.tf.set(b,e)}for(b in a.FA)this.Ur.set(b,a.FA[b]);a.NE&&(this.vm=a.NE)};var Qm=function(a,b){this.oO=a;this.Mo=new Om(this.Jl.bind(this),b);qf(this)};d=Qm.prototype;d.kc=function(){return this.Mo.kc()};d.W=function(a){return this.Mo.W(a)};d.Jl=function(){return this.oO.mX().then(function(a){return a.filter(function(a){return!a.EE()}).map(function(a){jh("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");return new Mm(a.getId(),a.Vf(),a.ob.personalizedInfo.maxRole,"default")})})};d.Ra=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.Mo.b()}]};
d.vb=function(){var a=nf(this);a&&this.Mo.hF(a.cache)};var Rm=function(a,b){this.input=a;this.domain=b};var Sm=function(a,b,c){this.DN=a;this.VX=b;this.Mj=new Om(this.Jl.bind(this),c);this.Dm=new A;qf(this)};Sm.prototype.a=C("mr.cloud.discovery.HangoutSinkDiscoveryService");Sm.prototype.Ss=function(a,b){a=new um(a,b,a,b);this.Dm.set(a.getId(),a);return a};Sm.prototype.addManualHangout=Sm.prototype.Ss;Sm.prototype.qH=function(a,b){this.hw(new um(a,b,a,b))};Sm.prototype.removeManualHangout=Sm.prototype.qH;d=Sm.prototype;d.kc=function(){return this.Mj.kc()};d.W=function(a){return this.Mj.W(a)};
d.Jl=function(){F(this.a,"Fetching hangouts");var a=this;return pe([this.VX.oQ(),this.DN.rQ()]).then(function(b){var c=y(a.Dm.A());b.forEach(function(b){b.RB?c=c.concat(b.value):D(a.a,"Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];jh("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.hw(b)})})};d.hw=function(a){return new Nm(a)};
d.zM=function(a){a=this.Ss(a.input,a.domain);a=this.hw(a);this.Mj.mo(a);return a.oc};d.j1=function(a){return this.Dm.remove(a.deviceId)?(this.Mj.gn(a.oc.id),!0):!1};d.Ra=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){return[{cache:this.Mj.b(),manualHangouts:this.Dm.b()}]};d.vb=function(){var a=nf(this);if(a){this.Mj.hF(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.Dm.set(b,new um(c.KE,c.Vc,c.bk,c.oj,c.Zd,c.ji))}}};var Tm=function(a){this.Hb=a};d=Tm.prototype;d.qj=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new xj(a+e);c&&(c=Hj(c),a.Ir(c));return a};d.Ug=function(a,b,c){var e=this;return e.Hb.getAuthToken().then(function(f){var g=e.LQ(f);return e.EN(g,a,b,c).na(function(g){if("INVALID_ACCESS_ERROR"==g)return e.$P(f,a,b,c);throw g;})})};d.$P=function(a,b,c,e){var f=this;return this.Hb.ZP(a).then(function(){return f.Ug(b,c,e)})};
d.EN=function(a,b,c,e){var f=J(),g=this;a.sendRequest(this.vQ(b,c,function(a){a&&!a.error?f.resolve(a):g.OW(a)?f.reject("INVALID_ACCESS_ERROR"):f.reject(g.r_(a))},e));return f.promise};d.OW=function(a){return!!a&&401==a.error.code};d.LQ=function(a){a=new qi(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.r_=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.vQ=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var Um=function(){this.ue=!1;this.$d=null;this.ig=!1;this.a=C("mr.cloud.identity.IdentityService");qf(this);this.oX();this.jJ()},Vm="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");d=Um.prototype;d.AE=function(){return"google.com"==this.PD()};
d.eX=function(){return this.ig||this.ue&&!!this.$d&&(-1!=Vm.indexOf(this.$d)||-1!=Vm.indexOf(this.PD()))};d.PD=function(){return this.$d?this.$d.substr(this.$d.indexOf("@")+1):""};d.getAuthToken=function(){return this.cC(!0)};
d.cC=function(a){return chrome.identity?new ie(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):I(Error("chrome.identity permission required for auth."))};d.ZP=function(a){return new ie(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.jJ=function(){var a=this;this.cC(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.ue=!!c.email||!!c.id;a.$d=c.email||null;b&&!a.ue&&(a.ig=!0)})},function(b){G(a.a,"Unable to set sign in and email.",b)})};d.oX=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.ue=c;F(a.a,"Signed in change: "+a.ue);a.ue?a.jJ():(a.$d=null,a.ig=!1)})};
d.U0=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return D(a.a,"gapi not loaded."),!1;F(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.Ra=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.ue,userEmail:this.$d,kioskAuth:this.ig}]};d.vb=function(){var a=of(this);a&&(a.signedIn&&(this.ue=a.signedIn),a.userEmail&&(this.$d=a.userEmail),a.kioskAuth&&(this.ig=a.kioskAuth))};var Wm={Wy:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},YK:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Xm=Wm,Xm=Wm;var Zm=function(a,b){var c=["0"];b=Ym[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},Ym={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var $m={Yy:".",Gs:",",bz:"%",Ls:"0",AL:"+",sL:"-",az:"E",cz:"\u2030",Hs:"\u221e",xL:"NaN",Xy:"#,##0.###",VL:"#E0",zL:"#,##0%",ZK:"\u00a4#,##0.00",bL:"USD"},an=$m,an=$m;var bn=function(a,b,c){this.om=b||an.bL;this.YO=c||0;this.Gq=40;this.Pd=1;this.wi=0;this.Oh=3;this.Mq=this.df=0;this.zJ=this.zK=!1;this.Vm=this.bi="";this.ng="-";this.gk="";this.nd=1;this.Uh=!1;this.Bh=[];this.rs=this.ZA=!1;this.wl=0;this.Xz=null;"number"==typeof a?this.PM(a):this.Ni(a)};d=bn.prototype;d.o4=function(a){if(0<this.wi&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.df=a;return this};d.j4=function(a){this.Oh=a;return this};
d.z5=function(a){if(0<this.df&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.wi=a;return this};d.Ni=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.bi=this.Xq(a,b);var c=b[0];this.Q_(a,b);c=b[0]-c;this.Vm=this.Xq(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.nd&&(this.Uh=!0),this.ng=this.Xq(a,b),b[0]+=c,this.gk=this.Xq(a,b)):(this.ng=this.bi+this.ng,this.gk+=this.Vm)};
d.PM=function(a){switch(a){case 1:this.Ni(an.Xy);break;case 2:this.Ni(an.VL);break;case 3:this.Ni(an.zL);break;case 4:this.Ni(Zm(an.ZK,this.om));break;case 5:this.Mz(1);break;case 6:this.Mz(2);break;default:throw Error("Unsupported pattern type.");}};d.Mz=function(a){this.wl=a;this.Ni(an.Xy);this.o4(0);this.j4(2);this.z5(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.wl)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.bi,b[0])==b[0],f=a.indexOf(this.ng,b[0])==b[0];e&&f&&(this.bi.length>this.ng.length?f=!1:this.bi.length<this.ng.length&&(e=!1));e?b[0]+=this.bi.length:f&&(b[0]+=this.ng.length);a.indexOf(an.Hs,b[0])==b[0]?(b[0]+=an.Hs.length,c=Infinity):c=this.B_(a,b);if(e){if(a.indexOf(this.Vm,b[0])!=b[0])return NaN;b[0]+=this.Vm.length}else if(f){if(a.indexOf(this.gk,
b[0])!=b[0])return NaN;b[0]+=this.gk.length}return f?-c:c};
d.B_=function(a,b){var c=!1,e=!1,f=!1,g=1,k=an.Yy,p=an.Gs,w=an.az;if(0!=this.wl)throw Error("Parsing of compact style numbers is not implemented");for(var B="";b[0]<a.length;b[0]++){var L=a.charAt(b[0]),U=this.AC(L);if(0<=U&&9>=U)B+=U,f=!0;else if(L==k.charAt(0)){if(c||e)break;B+=".";c=!0}else if(L==p.charAt(0)&&("\u00a0"!=p.charAt(0)||b[0]+1<a.length&&0<=this.AC(a.charAt(b[0]+1)))){if(c||e)break}else if(L==w.charAt(0)){if(e)break;B+="E";e=!0}else if("+"==L||"-"==L)B+=L;else if(1==this.nd&&L==an.bz.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.nd&&L==an.cz.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.nd&&(g=this.nd);return parseFloat(B)/g};d.format=function(a){if(isNaN(a))return an.xL;var b=[],c=this.bV(null===this.Xz?a:this.Xz,a);a/=Math.pow(10,c.Xt);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.ng:this.bi);isFinite(a)?(a=a*(e?-1:1)*this.nd,this.rs?this.Q6(a,b):this.sy(a,this.Pd,b)):b.push(an.Hs);b.push(e?this.gk:this.Vm);b.push(c.PJ);return b.join("")};
d.GH=function(a){var b=Math.pow(10,this.Oh),c=0>=this.wi?Math.round(a*b):Math.round(this.X1(a*b,this.wi,this.Oh));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{sE:a,yQ:b}};
d.sy=function(a,b,c){if(this.df>this.Oh)throw Error("Min value must be less than max value");c||(c=[]);a=this.GH(a);var e=Math.pow(10,this.Oh),f=a.sE,g=a.yQ,k=0==f?0:this.mq(f)+1,p=0<this.df||0<g||this.zJ&&k<this.wi;a=this.df;p&&(a=this.zJ&&0<this.wi?this.wi-k:this.df);for(var w="",k=f;1E20<k;)w="0"+w,k=Math.round(k/10);var w=k+w,B=an.Yy,k=an.Ls.charCodeAt(0),L=w.length,U=0;if(0<f||0<b){for(f=L;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.Bh.length)for(b=1;b<this.Bh.length;b++)U+=this.Bh[b];
b=L-U;if(0<b)for(var f=this.Bh,U=L=0,ia,Lb=an.Gs,yb=w.length,Mb=0;Mb<yb;Mb++){if(c.push(String.fromCharCode(k+1*Number(w.charAt(Mb)))),1<yb-Mb)if(ia=f[U],Mb<b){var cj=b-Mb;(1===ia||0<ia&&1===cj%ia)&&c.push(Lb)}else U<f.length&&(Mb===b?U+=1:ia===Mb-b-L+1&&(c.push(Lb),L+=ia,U+=1))}else{b=w;w=this.Bh;f=an.Gs;ia=b.length;Lb=[];for(L=w.length-1;0<=L&&0<ia;L--){U=w[L];for(yb=0;yb<U&&0<=ia-yb-1;yb++)Lb.push(String.fromCharCode(k+1*Number(b.charAt(ia-yb-1))));ia-=U;0<ia&&Lb.push(f)}c.push.apply(c,Lb.reverse())}}else p||
c.push(String.fromCharCode(k));(this.ZA||p)&&c.push(B);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.rz=function(a,b){b.push(an.az);0>a?(a=-a,b.push(an.sL)):this.zK&&b.push(an.AL);a=""+a;for(var c=an.Ls,e=a.length;e<this.Mq;e++)b.push(c);b.push(a)};
d.Q6=function(a,b){if(0==a)this.sy(a,this.Pd,b),this.rz(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a/=Math.pow(10,c);var e=this.Pd;if(1<this.Gq&&this.Gq>this.Pd){for(;0!=c%this.Gq;)a*=10,c--;e=1}else 1>this.Pd?(c++,a/=10):(c-=this.Pd-1,a*=Math.pow(10,this.Pd-1));this.sy(a,e,b);this.rz(c,b)}};d.AC=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=an.Ls.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.Xq=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.om;else switch(this.YO){case 0:c+=Ym[this.om][1];break;case 2:var g=this.om,k=Ym[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=Ym[this.om][2]}break;case "%":if(!this.Uh&&1!=this.nd)throw Error("Too many percent/permill");
if(this.Uh&&100!=this.nd)throw Error("Inconsistent use of percent/permill characters");this.nd=100;this.Uh=!1;c+=an.bz;break;case "\u2030":if(!this.Uh&&1!=this.nd)throw Error("Too many percent/permill");if(this.Uh&&1E3!=this.nd)throw Error("Inconsistent use of percent/permill characters");this.nd=1E3;this.Uh=!1;c+=an.cz;break;default:c+=g}}return c};
d.Q_=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,p=a.length,w=!0;b[0]<p&&w;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.Bh.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.rs)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.rs=!0;this.Mq=0;b[0]+1<p&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.zK=!0);for(;b[0]+1<p&&"0"==a.charAt(b[0]+1);)b[0]++,this.Mq++;if(1>e+f||1>this.Mq)throw Error('Malformed exponential pattern "'+a+'"');w=!1;break;default:b[0]--,w=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.Oh=0<=c?a-c:0;0<=c&&(this.df=e+f-c,0>this.df&&(this.df=0));this.Pd=(0<=c?c:a)-e;this.rs&&(this.Gq=e+this.Pd,0==this.Oh&&0==this.Pd&&(this.Pd=1));this.Bh.push(Math.max(0,k));this.ZA=
0==c||c==a};var cn={prefix:"",PJ:"",Xt:0};bn.prototype.KD=function(a,b){var c=1==this.wl?Xm.Wy:Xm.YK;null==c&&(c=Xm.Wy);if(3>a)return cn;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return cn;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],PJ:b[3],Xt:a+1-(b[2].length-1)}:cn:cn};
bn.prototype.bV=function(a){if(0==this.wl)return cn;a=Math.abs(a);var b=this.KD(1>=a?0:this.mq(a),"other").Xt;return this.KD(b+this.mq(this.GH(a/Math.pow(10,b)).sE),"other")};bn.prototype.mq=function(a){for(var b=0;1<=(a/=10);)b++;return b};bn.prototype.X1=function(a,b,c){if(!a)return a;b=b-this.mq(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var dn=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},en=dn,en=dn;var fn=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},gn=fn,gn=fn;var hn=function(a){this.Xj=[];this.Lw=[];this.rw=new bn(1);this.D_(a)},jn=/'([{}#].*?)'/g,kn=/''/g;d=hn.prototype;d.format=function(a){return this.up(a,!1)};d.up=function(a,b){if(0==this.Lw.length)return"";var c=[];this.su(this.Lw,a,b,c);for(a=c.join("");0<this.Xj.length;)a=a.replace(this.ot(this.Xj),this.Xj.pop());return a};
d.su=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.xQ(g,b,e);break;case 2:g=a[f].value;this.wQ(g,b,c,e);break;case 0:g=a[f].value;this.PB(g,b,gn,c,e);break;case 1:g=a[f].value;this.PB(g,b,en,c,e);break;default:hb("Unrecognized block type: "+a[f].type)}};d.xQ=function(a,b,c){b=b[a];l(b)?(this.Xj.push(b),c.push(this.ot(this.Xj))):c.push("Undefined parameter - "+a)};
d.wQ=function(a,b,c,e){var f=a.wo;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.su(f,b,c,e)):e.push("Undefined parameter - "+f)};d.PB=function(a,b,c,e,f){var g=a.wo,k=a.Oz,p=+b[g];isNaN(p)?f.push("Undefined or invalid parameter - "+g):(k=p-k,g=a[b[g]],l(g)||(c=this.rw.nT?c(k,this.rw.nT()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.su(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.rw.format(k),f.push(b.replace(/#/g,e))))};d.D_=function(a){a&&(a=this.zW(a),this.Lw=this.Yq(a))};
d.zW=function(a){var b=this.Xj,c=r(this.ot,this);a=a.replace(kn,function(){b.push("'");return c(b)});return a=a.replace(jn,function(a,f){b.push(f);return c(b)})};d.op=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var ln=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,mn=/^\s*(\w+)\s*,\s*selectordinal\s*,/,nn=/^\s*(\w+)\s*,\s*select\s*,/;d=hn.prototype;d.b_=function(a){return ln.test(a)?0:mn.test(a)?1:nn.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.Yq=function(a){var b=[];a=this.op(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.b_(a[c].value)){case 2:e.type=2;e.value=this.I_(a[c].value);break;case 0:e.type=0;e.value=this.E_(a[c].value);break;case 1:e.type=1;e.value=this.C_(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:hb("Unknown block type for pattern: "+a[c].value)}else hb("Unknown part of the pattern.");b.push(e)}return b};
d.I_=function(a){var b="";a=a.replace(nn,function(a,c){b=c;return""});var c={};c.wo=b;a=this.op(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Yq(a[e].value);else hb("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.E_=function(a){var b="",c=0;a=a.replace(ln,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.wo=b;e.Oz=c;a=this.op(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.Yq(a[f].value);else hb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.C_=function(a){var b="";a=a.replace(mn,function(a,c){b=c;return""});var c={};c.wo=b;c.Oz=0;a=this.op(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Yq(a[e].value);else hb("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.ot=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var on=chrome.i18n.getMessage("1522140683318860351"),pn=chrome.i18n.getMessage("4246483347873264186"),qn=chrome.i18n.getMessage("5991427458288444010"),rn=chrome.i18n.getMessage("5412436174832024705"),sn=chrome.i18n.getMessage("7735695102441495789"),tn=chrome.i18n.getMessage("4575332923598659024"),un=chrome.i18n.getMessage("2297080986956220930"),vn=new hn(un),wn=function(a,b){return vn.format({ORGANIZER:a,PARTICIPANTS:b})};var xn=function(a){this.rb=a;this.a=C("mr.cloud.mesi.MesiService")},yn={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};
xn.prototype.oQ=function(){var a=ym.Rg;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.rb.qj(a,["hangouts","search"]);F(this.a,"Retrieving Hangouts from MESI: "+a);return this.rb.Ug(a,"POST",yn).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var b=a.hangout,c,k;b.external_key?(c=b.external_key.value.replace(/@.*/,""),k=b.external_key.service):b.sharing_url&&(k=b.sharing_url.split("/"),c=k[4],k=k[3]);var p=b.meeting_room_name,w;b.meeting_domain?(w=b.meeting_domain,p&&(c=
p,k=w)):"BUSINESS"==b.type&&b.company_title&&(w=b.company_title.toLowerCase());var B=wn("",0);if((a=a.participant)&&0<a.length){var L=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(L=b.display_name);return a},new Sc);B=wn(L,a.N())}return new um(c,k,p,w,B,b.hangout_id)}));return c})};var zn=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},An=function(a){this.rb=a};An.$inject=["gapiService"];d=An.prototype;d.u2=function(a,b,c){var e=this;return this.YH(Im,a,b,c,35E3).then(function(a){return e.YD(a)})};d.w2=function(a,b,c){var e=this;return this.YH(Hm,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.IG(a),new zn(b,a.type,new Dm(a.sessionDescription))):new zn(b)})};d.A2=function(a){return this.se(a,Gm,{})};
d.YH=function(a,b,c,e,f){c={_settings:c.settings.wy(),_optMediaConstraints:JSON.stringify(c.mediaConstraints),_webrtcMessage:JSON.stringify(new Dm(c.description))};e&&(c._user=JSON.stringify(e));return this.se(b,a,c,f)};d.YD=function(a){var b=a.state;switch(b){case "done":return H(this.n_(a));case "queued":case "inProgress":var c=this;return c.W7(a).then(function(a){return c.YD(a)});default:return H(new zn(b))}};
d.W7=function(a){var b=this,c=J(),e=setInterval(function(){b.eQ(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c.resolve(a))})},2E3);return c.promise};d.n_=function(a){a=this.IG(a);return"__cloud_webrtc_session_message__"==a.type?new zn("done","knocking_cloud_webrtc_session_message",new Dm(a.sessionDescription)):new zn("done",a.type)};
d.se=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.rb.qj(wm.Rg,["commands"],b);return this.rb.Ug(e,"POST",a)};d.IG=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};d.eQ=function(a){a=this.rb.qj(wm.Rg,["commands",a]);return this.rb.Ug(a,"GET")};var Bn=function(a,b,c,e){this.Ue=a;this.Hb=b;this.Tn=c;this.qc=e};d=Bn.prototype;d.LV=function(a,b,c){var e=this;return this.q2(a,b,c).then(function(a){return e.yV(a,b.id)})};d.EV=function(a){var b=this;return this.Tn.qR().then(function(c){b.qc.Sd(new wh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.q2=function(a,b,c){b=c.deviceId;var e=this.Hb.$d,e=e?new Bm(e):void 0;a=a.data;switch(c.Ms){case "owner":tm(0);break;case "manager":tm(1);break;case "user":tm(2);break;case "viewer":tm(3)}return"viewer"==c.Ms?this.Ue.u2(b,a,e):this.Ue.w2(b,a,e)};
d.yV=function(a,b){if("done"!=a.state)return I(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new wh("ANSWER",a.results.sessionDescription);this.qc.Sd(a,b);break;case "knocking_cloud_webrtc_session_message":qm(0);a=new wh("KNOCK_ANSWER",a.results.sessionDescription);this.qc.Sd(a,b);break;case "knock_denied":qm(1);this.XD(pn,b);break;case "knock_timeout":qm(2);this.XD(qn,b);break;default:return I(Error("Invalid message type: "+a.type))}return H()};
d.XD=function(a,b){a=new ah(a,"warning","dismiss");a.X3(!0);this.qc.Ve().send(a);this.qc.Sd(new wh("STOP"),b)};var Cn=function(a,b){this.Hb=a;this.qc=b};
Cn.prototype.HV=function(a,b,c){switch(a.type){case "REFRESH_AUTH":var e=c.deviceId,f=c.zH,g=this;return this.Hb.U0().then(function(){g.qc.Sd(new wh("AUTH_READY",{hangoutId:e,resolvedId:f,conferenceMode:!1}),b.id)});case "STATUS_REQUEST":return this.qc.Sd(a,b.id),H();case "STATUS_RESPONSE":return this.qc.Sd(a,b.id,!0),a.data.routeDescription||this.qc.Sd(a,b.id),H();case "HANGOUT_INACTIVE":return this.qc.Ei(b,4,new ah(sn,"warning","dismiss"));case "HANGOUT_INVALID":return this.qc.Ei(b,3,new ah(tn,
"warning","dismiss"));default:return I(Error("Unknown type: "+a.type))}};var Dn=function(a,b,c){this.Zi=a;this.lm=b;this.qc=c};
Dn.prototype.k0=function(a,b,c,e){switch(a){case "cloud":break;case "mesi":break;default:return I(Error("Unrecognized channel type"))}if(!b.type)return I(Error("Message has no type"));switch(b.type){case "STOP":return this.qc.Ei(c,1,null);case "SESSION_START_SUCCESS":return rm(0),H();case "SESSION_END":return H();case "SESSION_FAILURE":return rm(1),this.qc.Ei(c,2,new ah(on,"warning","dismiss"));case "__webrtc_stats__":return H();case "OFFER":return this.Zi.LV(b,c,e);case "GET_TURN_CREDENTIALS":return this.Zi.EV(c);
case "REFRESH_AUTH":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":return this.lm.HV(b,c,e);default:return I(Error("Unknown type: "+b.type))}};var En=function(){this.a=C("mr.cloud.settings.SettingsService")};d=En.prototype;d.m7=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&E(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};d.mR=function(){var a=this;return this.oC().na(function(){return a.oC().na(function(b){E(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.oC=function(){return this.PC("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};
d.PC=function(a){var b=J();chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};d.mC=function(){var a=this;return this.nC().na(function(){return a.nC().na(function(b){E(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.nC=function(){return this.ST("media_router.cloudservices.enabled").then(function(a){return!!a.value})};
d.ST=function(a){var b=J();chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};d.E4=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&E(a,"Error setting notified Hangout privacy: "+JSON.stringify(chrome.runtime.lastError))})};
d.ET=function(){var a=this;return this.eD().na(function(){return a.eD().na(function(b){E(a.a,"Error retrieving hangouts notified setting: "+JSON.stringify(b));return!1})})};d.eD=function(){return this.PC("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Fn=function(a){this.a=C("mr.cloud.CredentialService");this.rb=a};Fn.prototype.qR=function(){var a=this,b=J(),c=zm.Rg+"/iceconfig?key="+zm.n7;F(this.a,"Requesting TURN credentials from "+c);var e=dg(c,function(){return a.VZ(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};Fn.prototype.VZ=function(a,b){a.kd()?(F(this.a,"Got TURN credentials: "+a.Gj()),b.resolve(this.MY(a.oU()))):b.resolve(this.NY(null))};
Fn.prototype.MY=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:a.credential,username:a.username})})});return b}catch(c){return D(this.a,"Error parsing TURN credentials.",c),[]}};Fn.prototype.NY=function(a){D(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var Gn=function(){this.Tn=this.Ud=this.dk=this.lm=this.Zi=this.Ue=this.nv=this.st=this.lw=this.It=this.Gt=this.rb=this.et=null};za(Gn);d=Gn.prototype;d.Vl=function(){null==this.et&&(this.et=new Um);return this.et};d.Ul=function(){null==this.rb&&(this.rb=new Tm(this.Vl()));return this.rb};d.kR=function(){null==this.Gt&&(this.Gt=new Km(this.Ul()));return this.Gt};d.nR=function(a){null==this.It&&(this.It=new Qm(this.kR(),a));return this.It};
d.jT=function(){null==this.lw&&(this.lw=new xn(this.Ul()));return this.lw};d.WQ=function(){null==this.st&&(this.st=new Am(this.Ul(),this.Vl()));return this.st};d.rS=function(a){null==this.nv&&(this.nv=new Sm(this.WQ(),this.jT(),a));return this.nv};d.GC=function(){null==this.Ue&&(this.Ue=new An(this.Ul()));return this.Ue};d.lR=function(a){null==this.Zi&&(this.Zi=new Bn(this.GC(),this.Vl(),this.ZU(),a));return this.Zi};d.kS=function(a){null==this.lm&&(this.lm=new Cn(this.Vl(),a));return this.lm};
d.kT=function(a){null==this.dk&&(this.dk=new Dn(this.lR(a),this.kS(a),a));return this.dk};d.DU=function(){null==this.Ud&&(this.Ud=new En);return this.Ud};d.ZU=function(){null==this.Tn&&(this.Tn=new Fn(this.Ul()));return this.Tn};var Hn=function(a){this.C=a;this.$a=new A;this.xi=[];this.Ud=this.dk=this.Hb=this.Ue=this.Nd=null;this.Nj=this.jk=this.Zg=this.Yi=!1;qf(this)};Hn.prototype.a=C("mr.CloudProvider");var In=new Hi("pseudo:cloud","","hangout","Add a hangout","default");d=Hn.prototype;d.getName=function(){return"cloud"};
d.jd=function(){F(this.a,"Initializing Cloud MRP");var a=Gn.O(),b=a.nR(this);this.xi.push(b);this.Nd=a.rS(this);this.xi.push(this.Nd);this.Ue=a.GC();this.Hb=a.Vl();this.dk=a.kT(this);this.Ud=a.DU();var c=this;this.Ud.mC().then(function(a){c.Yi=a;F(c.a,"Cloud enabled setting: "+c.Yi)});this.Ud.mR().then(function(a){c.Zg=a;F(c.a,"Cloud on setting: "+c.Zg)});this.Ud.ET().then(function(a){c.jk=a;F(c.a,"Privacy notified setting: "+c.jk)})};d.Ye=function(){return this.$a.A()};
d.Ol=function(a){if(!this.oq(a))return hk;G(this.a,"GetAvailableSinks for "+a);var b=[];if(this.Zg||this.i6())F(this.a,"Checking cloud discovery services"),Rf.O().vq=t(),this.xi.forEach(function(a){a=a.kc();b=b.concat(a)});G(this.a,"Available sinks are..."+JSON.stringify(b));var c=b.map(function(a){return a.oc});this.Nd&&(c=c.concat(In));return new gk(c,-1!=a.indexOf("0F5096E8")?rh:null)};
d.Bi=function(a){if((this.Hb.ig||this.Hb.AE())&&!this.Nj){var b=Jn(a);F(this.a,"startObservingMediaSinks");G(this.a,"urn: "+a);b&&(this.Nd.Ss(b,"google.com"),this.Nj=!0,this.C.pc(),this.C.onSinkAvailabilityUpdated(this,2),F(this.a,"sinkAvailability changed to AVAILABLE"))}};d.Di=function(a){this.oq(a)&&(F(this.a,"stopObservingMediaSinks"),G(this.a,"urn: "+a),(this.Hb.ig||this.Hb.AE())&&this.Nj&&(a=Jn(a)))&&(this.Nd.qH(a,"google.com"),this.Nj=!1)};d.Ai=function(){};d.Ci=function(){};
d.W=function(a){return(a=this.uj(a))?a.oc:null};d.fe=function(a,b,c,e,f,g,k){F(this.a,"createRoute called");G(this.a,"urn: "+a+" sinkId:"+b);f=this.uj(b);return this.ep(a,f,b,c,e,g,k)};
d.ep=function(a,b,c,e,f,g,k){var p=this;if(f)return I(Error("not supported"));f=!1;switch(this.Wu(b)){case "cloud":sm(1);break;case "mesi":f=!0,this.jk||(this.jk=!0,this.Ud.E4(),g=new ah(rn,"notification","learn_more"),g.r5(["dismiss"]),g.S3(6320939),this.C.Ve().send(g)),sm(0)}Rf.O().fi=new Qf(b.qe,null);var w=lk(e,this.getName(),c,a,!0,"",null);f&&(w.customControllerPath="cloud_route_details/view.html?routeId="+w.id);this.$a.set(w.id,w);this.C.lk(this,w);F(this.a,"starting mirroring on route: "+
w.id);w.pe={tabId:k,sessionId:"",AJ:"",BJ:b.qe};return this.C.Jn(this,w).na(function(a){a instanceof he?p.Ei(w,6,null):(D(p.a,"Error on start mirroring",a),p.Ei(w,5,new ah(on,"warning","dismiss")));p.Nd&&p.Nd.j1(b)&&p.ff([b.oc]);throw a;})};d.tc=function(a){F(this.a,"terminating route: "+a);return(a=this.$a.get(a))?this.Ei(a,0,null):H()};d.Ei=function(a,b,c){this.$a.remove(a.id);c&&this.Ve().send(c);kh("MediaRouter.Cloud.Session.End",b,nm);this.nO(a);this.C.Wh(this,a);return H()};
d.Cg=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.$a.get(a)||void 0)?this.uj(a.sinkId):void 0;return this.dk.k0(c,b,a,e)}if(n(b)){b=JSON.parse(b);if("STATUS_REQUEST"==b.type||"MUTE"==b.type)return this.Sd(b,a),H();if(b.clientId)return this.vV(b,a)}return I(Error("Channel type missing"))};d.Zf=function(){return bi(!0,!0)};d.Xl=function(a){var b=null;a=this.uj(a);switch(this.Wu(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}F(this.a,"mirror service: "+b);return b};
d.ql=function(a,b){G(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.oq(a)&&!!this.W(b)};d.Ti=function(a){return"chrome://media-router/cloudmrp-mirroring"==a};d.Hh=function(a,b){return(a=this.$a.get(b))?H(a):I(Error("not supported"))};d.$g=function(){return I(Error("not supported"))};d.Pf=function(){};
d.sG=function(a){F(this.a,a.length+" sinks added");0<a.length&&!this.Zg&&(this.Ud.m7(),this.Zg=!0);a=this.uj(a[0].id);Rf.O().ei=new Qf(a.qe,null);this.C.pc();this.C.onSinkAvailabilityUpdated(this,2);F(this.a,"sinkAvailability changed to AVAILABLE")};d.ff=function(a){F(this.a,a.length+" sinks removed");this.xi.some(function(a){return 0<a.kc().length})||(this.C.onSinkAvailabilityUpdated(this,0),F(this.a,"sinkAvailability changed to UNAVAILABLE"));this.C.pc()};
d.pc=function(a){F(this.a,a.length+" sinks updated");this.C.pc()};d.Ve=function(){return this.C.Ve()};d.Sd=function(a,b,c){c?this.C.Qd(this,b,a):this.C.Rq(this,b,a)};d.uj=function(a){var b=null;this.xi.some(function(c){if(c=c.W(a))return b=c,!!c});return b};d.nO=function(a){a=this.uj(a.sinkId);switch(this.Wu(a)){case "cloud":this.Ue.A2(a.deviceId)}};d.Wu=function(a){return a.QJ("cloud")?"cloud":a.QJ("mesi")?"mesi":null};d.i6=function(){var a=Rf.O().vq;return 3E5<=t()-a};
d.oq=function(a){var b=this;a=qh(a);if(this.Hb.ig&&!this.Hb.ue&&a)return this.C.onSinkAvailabilityUpdated(this,2),!0;var c=!1,e=this;this.Ud.mC().then(function(a){e.Yi=a});this.Yi&&this.Hb.ue&&(c=!0);c=c&&a;chrome.declarativeWebRequest||this.Hb.eX()||!this.Nd||(this.xi=this.xi.filter(function(a){return a!=b.Nd}),this.Nd=null);return c};d.rf=function(a,b){if(!this.oq(a))return null;(a=this.Nd.zM(b))&&this.sG([a]);return a};
var Jn=function(a){return(a=(new xj(a)).Sf.match("__castMeetingName__=([^/]*)"))?a[1]:null};Hn.prototype.Ra=function(){return"CloudProvider"};Hn.prototype.getData=function(){return[{hasPresentationUrlSink:this.Nj},{cloudEnabled:this.Yi,cloudOn:this.Zg,notifiedHangoutsPrivacy:this.jk}]};Hn.prototype.vb=function(){var a=nf(this);a&&(this.Nj=a.hasPresentationUrlSink);if(a=of(this))a.cloudEnabled&&(this.Yi=a.cloudEnabled),a.cloudOn&&(this.Zg=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.jk=a.notifiedHangoutsPrivacy)};
Hn.prototype.vV=function(a,b){var c=a.clientId;return c?("client_connect"==a.type?this.Sd({message:{sessionId:"castouts"},clientId:c,type:"new_session"},b,!0):"v2_message"==a.type&&"STOP"==a.message.type&&(this.Sd({message:"castouts",clientId:c,type:"remove_session"},b,!0),this.tc(b)),H()):I(Error("Invalid cast message"))};var Kn=C("mr.external.MessageHandler"),Ln=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"],Mn=0,Nn=function(a,b,c,e){if(c.id&&-1!=Ln.indexOf(c.id)){F(Kn,"Received a message from "+c.id+" type: "+b.type);var f=chrome.runtime.id;if("start"==b.type)b=b.message,b=a.rf("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Rm(b.meetingName,b.domain)),c="PresentationId"+c.id+Mn++,a.fe("urn:x-org.chromium.media:source:desktop",b,c).then(function(a){e(new mg(f,
"route",a.id))}).catch(function(a){e(new mg(f,"error",a))});else if("stop"==b.type)a.tc(b.message.routeId),e(new mg(f,"stopped"));else return;return!0}};var On=function(){this.WG=r(this.yM,this);this.Gd=new ni;this.Gd.jy=!1;this.Gd.Sr=!1;this.xE=this.Gd.Lz=!1;this.lF="";this.lQ={}};On.prototype.b3=function(a){if(a!=this.xE){var b=Pd();a?b.sz(this.WG):b.i1(this.WG);this.xE=a}};On.prototype.yM=function(a){if(!this.lQ[a.oF]){var b=this.Gd.QB(a),c=Pn;if(c)switch(a.Jh){case Ed:Qn(c,"info",b);break;case Fd:Qn(c,"error",b);break;case Gd:Qn(c,"warn",b);break;default:Qn(c,"debug",b)}else this.lF+=b}};var Pn=h.console,Qn=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var Rn=function(){this.Ge=new gi(1E3);this.Gd=new ni};za(Rn);d=Rn.prototype;d.init=function(){var a=this.xR();Qd("mr").Kk(a);Qd("goog").Kk(Hd);ud(Rd(Qd("browser")));Pd().sz(r(this.dZ,this));this.Gd.ky=!0;this.Gd.Sr=!0;if(a=window.localStorage["debug.logs"]){var b={all:Ld,fine:Jd,info:Hd,warning:Gd,severe:Fd,off:Dd};Qd("mr").Kk(b[a.toLowerCase()]||Jd)}window.localStorage["debug.console"]&&(a=new On,a.Gd.ky=!0,a.Gd.Sr=!0,a.Gd.jy=!0,a.b3(!0))};
d.dZ=function(a){this.Ge.add(this.Gd.QB(a));(a=a.np)&&a.stack&&this.Ge.add(a.stack)};d.getLogs=function(){return 0==this.Ge.N()?"NA":this.Ge.A().join("")};d.xR=function(){return Hd};d.W0=function(){qf(this)};d.Ra=function(){return"LogManager"};d.getData=function(){return[this.Ge.A()]};d.vb=function(){var a=this.Ge.A();this.Ge.clear();(nf(this)||[]).forEach(function(a){this.Ge.add(a)},this);a.forEach(function(a){this.Ge.add(a)},this)};var Sn,Tn=C("mr.Init"),Un=function(a){var b;b=new wk(a);var c=new pl(a,b);b=[b,c];b.push(new Hn(a));return b};Rn.O().init();Sn=new eh("MediaRouter.Provider.WakeDuration");
var Vn=new im,Wn=function(){var a=J();switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a.resolve();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(b){chrome.runtime.lastError||!b.enabled?a.resolve():a.reject("Dev extension is enabled")});break;default:a.reject("Unknown extension id")}return a.promise}().then(function(){if(!chrome.mojoPrivate||!chrome.mojoPrivate.requireAsync)return I(Error("No mojo service loaded"));var a=
J();chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a.resolve({mrService:b,mrInstanceId:c})})});return a.promise}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");F(Tn,"MR instance ID: "+b);a=a.mrService;if(!Vn)throw Error("providerManager not initialized.");a.setHandlers(Vn);sf(b)&&Sn.Lk("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(Sn.end.bind(Sn));
wf(b);Rn.O().W0();b=Un(Vn);ue=function(a){var b=a;b.stack||(b=Error(a));D(Tn,"Unhandled promise rejection.",b)};Vn.jd(a,b)}).na(function(a){E(Tn,a.message);throw a;});
(function(a){chrome.runtime.onMessage.addListener(function(b,c,e){if(c.id==chrome.runtime.id&&"chrome-extension://"+c.id+"/feedback.html"==c.url&&"retrieve_log_data"==b.type){var f={logs:Rn.O().getLogs(),device:Rf.O().$T()},g="Chromecast"==f.device.model?lg(f.device.ip):H();a.oT("cast_streaming").then(function(a){return a.pT(b.source)}).then(function(a){f.castStreamingLogs=a}).Ab(function(){g.then(function(a){a&&(f.device.version=a)}).Ab(function(){e(f)})});return!0}});chrome.runtime.onMessageExternal.addListener(Nn.bind(void 0,
a))})(Vn);Wn.na(function(){window.close()});
